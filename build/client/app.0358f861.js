parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Cyzn":[function(require,module,exports) {
"use strict";function e(t){window.requestAnimationFrame(function(i){e(t),t(i)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ticker=e;
},{}],"vSqo":[function(require,module,exports) {
function n(){}module.exports=n,n.appendArray=function(n,e){if(e.length<15e4)n.push.apply(n,e);else for(var r=0,t=e.length;r!==t;++r)n.push(e[r])},n.splice=function(n,e,r){r=r||1;for(var t=e,f=n.length-r;t<f;t++)n[t]=n[t+r];n.length=f},"undefined"!=typeof P2_ARRAY_TYPE?n.ARRAY_TYPE=P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?n.ARRAY_TYPE=Float32Array:n.ARRAY_TYPE=Array,n.extend=function(n,e){for(var r in e)n[r]=e[r]},n.defaults=function(n,e){for(var r in n=n||{},e)r in n||(n[r]=e[r]);return n};
},{}],"jK4t":[function(require,module,exports) {
var t=module.exports={},n=require("../utils/Utils");t.crossLength=function(t,n){return t[0]*n[1]-t[1]*n[0]},t.crossVZ=function(n,r,e){return t.rotate(n,r,-Math.PI/2),t.scale(n,n,e),n},t.crossZV=function(n,r,e){return t.rotate(n,e,Math.PI/2),t.scale(n,n,r),n},t.rotate=function(t,n,r){if(0!==r){var e=Math.cos(r),u=Math.sin(r),o=n[0],c=n[1];t[0]=e*o-u*c,t[1]=u*o+e*c}else t[0]=n[0],t[1]=n[1]},t.rotate90cw=function(t,n){var r=n[0],e=n[1];t[0]=e,t[1]=-r},t.toLocalFrame=function(n,r,e,u){t.copy(n,r),t.sub(n,n,e),t.rotate(n,n,-u)},t.toGlobalFrame=function(n,r,e,u){t.copy(n,r),t.rotate(n,n,u),t.add(n,n,e)},t.vectorToLocalFrame=function(n,r,e){t.rotate(n,r,-e)},t.vectorToGlobalFrame=function(n,r,e){t.rotate(n,r,e)},t.centroid=function(n,r,e,u){return t.add(n,r,e),t.add(n,n,u),t.scale(n,n,1/3),n},t.create=function(){var t=new n.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t},t.clone=function(t){var r=new n.ARRAY_TYPE(2);return r[0]=t[0],r[1]=t[1],r},t.fromValues=function(t,r){var e=new n.ARRAY_TYPE(2);return e[0]=t,e[1]=r,e},t.copy=function(t,n){return t[0]=n[0],t[1]=n[1],t},t.set=function(t,n,r){return t[0]=n,t[1]=r,t},t.add=function(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t},t.subtract=function(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t},t.sub=t.subtract,t.multiply=function(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t},t.mul=t.multiply,t.divide=function(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t},t.div=t.divide,t.scale=function(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t},t.distance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1];return Math.sqrt(r*r+e*e)},t.dist=t.distance,t.squaredDistance=function(t,n){var r=n[0]-t[0],e=n[1]-t[1];return r*r+e*e},t.sqrDist=t.squaredDistance,t.length=function(t){var n=t[0],r=t[1];return Math.sqrt(n*n+r*r)},t.len=t.length,t.squaredLength=function(t){var n=t[0],r=t[1];return n*n+r*r},t.sqrLen=t.squaredLength,t.negate=function(t,n){return t[0]=-n[0],t[1]=-n[1],t},t.normalize=function(t,n){var r=n[0],e=n[1],u=r*r+e*e;return u>0&&(u=1/Math.sqrt(u),t[0]=n[0]*u,t[1]=n[1]*u),t},t.dot=function(t,n){return t[0]*n[0]+t[1]*n[1]},t.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},t.lerp=function(t,n,r,e){var u=n[0],o=n[1];return t[0]=u+e*(r[0]-u),t[1]=o+e*(r[1]-o),t},t.reflect=function(t,n,r){var e=n[0]*r[0]+n[1]*r[1];t[0]=n[0]-2*r[0]*e,t[1]=n[1]-2*r[1]*e},t.getLineSegmentsIntersection=function(n,r,e,u,o){var c=t.getLineSegmentsIntersectionFraction(r,e,u,o);return!(c<0)&&(n[0]=r[0]+c*(e[0]-r[0]),n[1]=r[1]+c*(e[1]-r[1]),!0)},t.getLineSegmentsIntersectionFraction=function(t,n,r,e){var u,o,c=n[0]-t[0],a=n[1]-t[1],i=e[0]-r[0],s=e[1]-r[1];return u=(-a*(t[0]-r[0])+c*(t[1]-r[1]))/(-i*a+c*s),o=(i*(t[1]-r[1])-s*(t[0]-r[0]))/(-i*a+c*s),u>=0&&u<=1&&o>=0&&o<=1?o:-1};
},{"../utils/Utils":"vSqo"}],"YFQU":[function(require,module,exports) {
var o=require("../math/vec2"),r=require("../utils/Utils");function t(r){this.lowerBound=o.create(),r&&r.lowerBound&&o.copy(this.lowerBound,r.lowerBound),this.upperBound=o.create(),r&&r.upperBound&&o.copy(this.upperBound,r.upperBound)}module.exports=t;var u=o.create();t.prototype.setFromPoints=function(r,t,e,n){var p=this.lowerBound,i=this.upperBound;"number"!=typeof e&&(e=0),0!==e?o.rotate(p,r[0],e):o.copy(p,r[0]),o.copy(i,p);for(var d=Math.cos(e),h=Math.sin(e),a=1;a<r.length;a++){var s=r[a];if(0!==e){var B=s[0],l=s[1];u[0]=d*B-h*l,u[1]=h*B+d*l,s=u}for(var c=0;c<2;c++)s[c]>i[c]&&(i[c]=s[c]),s[c]<p[c]&&(p[c]=s[c])}t&&(o.add(this.lowerBound,this.lowerBound,t),o.add(this.upperBound,this.upperBound,t)),n&&(this.lowerBound[0]-=n,this.lowerBound[1]-=n,this.upperBound[0]+=n,this.upperBound[1]+=n)},t.prototype.copy=function(r){o.copy(this.lowerBound,r.lowerBound),o.copy(this.upperBound,r.upperBound)},t.prototype.extend=function(o){for(var r=2;r--;){var t=o.lowerBound[r];this.lowerBound[r]>t&&(this.lowerBound[r]=t);var u=o.upperBound[r];this.upperBound[r]<u&&(this.upperBound[r]=u)}},t.prototype.overlaps=function(o){var r=this.lowerBound,t=this.upperBound,u=o.lowerBound,e=o.upperBound;return(u[0]<=t[0]&&t[0]<=e[0]||r[0]<=e[0]&&e[0]<=t[0])&&(u[1]<=t[1]&&t[1]<=e[1]||r[1]<=e[1]&&e[1]<=t[1])},t.prototype.containsPoint=function(o){var r=this.lowerBound,t=this.upperBound;return r[0]<=o[0]&&o[0]<=t[0]&&r[1]<=o[1]&&o[1]<=t[1]},t.prototype.overlapsRay=function(o){var r=1/o.direction[0],t=1/o.direction[1],u=(this.lowerBound[0]-o.from[0])*r,e=(this.upperBound[0]-o.from[0])*r,n=(this.lowerBound[1]-o.from[1])*t,p=(this.upperBound[1]-o.from[1])*t,i=Math.max(Math.max(Math.min(u,e),Math.min(n,p))),d=Math.min(Math.min(Math.max(u,e),Math.max(n,p)));return d<0?-1:i>d?-1:i};
},{"../math/vec2":"jK4t","../utils/Utils":"vSqo"}],"rHYJ":[function(require,module,exports) {
function n(){}module.exports=n,n.eq=function(n,t,e){return e=e||0,Math.abs(n-t)<e};
},{}],"OjV7":[function(require,module,exports) {
var r=require("./Scalar");function e(){}module.exports=e,e.lineInt=function(e,n,t){t=t||0;var u,a,i,c,o,f,s,v=[0,0];return u=e[1][1]-e[0][1],a=e[0][0]-e[1][0],i=u*e[0][0]+a*e[0][1],c=n[1][1]-n[0][1],o=n[0][0]-n[1][0],f=c*n[0][0]+o*n[0][1],s=u*o-c*a,r.eq(s,0,t)||(v[0]=(o*i-a*f)/s,v[1]=(u*f-c*i)/s),v},e.segmentsIntersect=function(r,e,n,t){var u=e[0]-r[0],a=e[1]-r[1],i=t[0]-n[0],c=t[1]-n[1];if(i*a-c*u==0)return!1;var o=(u*(n[1]-r[1])+a*(r[0]-n[0]))/(i*a-c*u),f=(i*(r[1]-n[1])+c*(n[0]-r[0]))/(c*u-i*a);return o>=0&&o<=1&&f>=0&&f<=1};
},{"./Scalar":"rHYJ"}],"S8qn":[function(require,module,exports) {
function r(){}module.exports=r,r.area=function(r,n,t){return(n[0]-r[0])*(t[1]-r[1])-(t[0]-r[0])*(n[1]-r[1])},r.left=function(n,t,a){return r.area(n,t,a)>0},r.leftOn=function(n,t,a){return r.area(n,t,a)>=0},r.right=function(n,t,a){return r.area(n,t,a)<0},r.rightOn=function(n,t,a){return r.area(n,t,a)<=0};var n=[],t=[];r.collinear=function(a,e,u,i){if(i){var o=n,f=t;o[0]=e[0]-a[0],o[1]=e[1]-a[1],f[0]=u[0]-e[0],f[1]=u[1]-e[1];var c=o[0]*f[0]+o[1]*f[1],s=Math.sqrt(o[0]*o[0]+o[1]*o[1]),h=Math.sqrt(f[0]*f[0]+f[1]*f[1]);return Math.acos(c/(s*h))<i}return 0==r.area(a,e,u)},r.sqdist=function(r,n){var t=n[0]-r[0],a=n[1]-r[1];return t*t+a*a};
},{}],"xJCm":[function(require,module,exports) {
var t=require("./Line"),e=require("./Point"),i=require("./Scalar");function s(){this.vertices=[]}module.exports=s,s.prototype.at=function(t){var e=this.vertices,i=e.length;return e[t<0?t%i+i:t%i]},s.prototype.first=function(){return this.vertices[0]},s.prototype.last=function(){return this.vertices[this.vertices.length-1]},s.prototype.clear=function(){this.vertices.length=0},s.prototype.append=function(t,e,i){if(void 0===e)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<e)throw new Error("lol1");if(i>t.vertices.length)throw new Error("lol2");if(e<0)throw new Error("lol3");for(var s=e;s<i;s++)this.vertices.push(t.vertices[s])},s.prototype.makeCCW=function(){for(var t=0,i=this.vertices,s=1;s<this.vertices.length;++s)(i[s][1]<i[t][1]||i[s][1]==i[t][1]&&i[s][0]>i[t][0])&&(t=s);e.left(this.at(t-1),this.at(t),this.at(t+1))||this.reverse()},s.prototype.reverse=function(){for(var t=[],e=0,i=this.vertices.length;e!==i;e++)t.push(this.vertices.pop());this.vertices=t},s.prototype.isReflex=function(t){return e.right(this.at(t-1),this.at(t),this.at(t+1))};var r=[],h=[];function n(t,e,s,r,h){h=h||0;var n=e[1]-t[1],a=t[0]-e[0],o=n*t[0]+a*t[1],c=r[1]-s[1],p=s[0]-r[0],v=c*s[0]+p*s[1],l=n*p-c*a;return i.eq(l,0,h)?[0,0]:[(p*o-a*v)/l,(n*v-c*o)/l]}s.prototype.canSee=function(i,s){var n,a,o=r,c=h;if(e.leftOn(this.at(i+1),this.at(i),this.at(s))&&e.rightOn(this.at(i-1),this.at(i),this.at(s)))return!1;a=e.sqdist(this.at(i),this.at(s));for(var p=0;p!==this.vertices.length;++p)if((p+1)%this.vertices.length!==i&&p!==i&&e.leftOn(this.at(i),this.at(s),this.at(p+1))&&e.rightOn(this.at(i),this.at(s),this.at(p))&&(o[0]=this.at(i),o[1]=this.at(s),c[0]=this.at(p),c[1]=this.at(p+1),n=t.lineInt(o,c),e.sqdist(this.at(i),n)<a))return!1;return!0},s.prototype.copy=function(t,e,i){var r=i||new s;if(r.clear(),t<e)for(var h=t;h<=e;h++)r.vertices.push(this.vertices[h]);else{for(h=0;h<=e;h++)r.vertices.push(this.vertices[h]);for(h=t;h<this.vertices.length;h++)r.vertices.push(this.vertices[h])}return r},s.prototype.getCutEdges=function(){for(var t=[],e=[],i=[],r=new s,h=Number.MAX_VALUE,n=0;n<this.vertices.length;++n)if(this.isReflex(n))for(var a=0;a<this.vertices.length;++a)if(this.canSee(n,a)){e=this.copy(n,a,r).getCutEdges(),i=this.copy(a,n,r).getCutEdges();for(var o=0;o<i.length;o++)e.push(i[o]);e.length<h&&(t=e,h=e.length,t.push([this.at(n),this.at(a)]))}return t},s.prototype.decomp=function(){var t=this.getCutEdges();return t.length>0?this.slice(t):[this]},s.prototype.slice=function(t){if(0==t.length)return[this];if(t instanceof Array&&t.length&&t[0]instanceof Array&&2==t[0].length&&t[0][0]instanceof Array){for(var e=[this],i=0;i<t.length;i++)for(var s=t[i],r=0;r<e.length;r++){var h=e[r].slice(s);if(h){e.splice(r,1),e.push(h[0],h[1]);break}}return e}s=t,i=this.vertices.indexOf(s[0]),r=this.vertices.indexOf(s[1]);return-1!=i&&-1!=r&&[this.copy(i,r),this.copy(r,i)]},s.prototype.isSimple=function(){for(var e=this.vertices,i=0;i<e.length-1;i++)for(var s=0;s<i-1;s++)if(t.segmentsIntersect(e[i],e[i+1],e[s],e[s+1]))return!1;for(i=1;i<e.length-2;i++)if(t.segmentsIntersect(e[0],e[e.length-1],e[i],e[i+1]))return!1;return!0},s.prototype.quickDecomp=function(t,i,r,h,a,o){a=a||100,o=o||0,h=h||25,t=void 0!==t?t:[],i=i||[],r=r||[];var c=[0,0],p=[0,0],v=[0,0],l=0,f=0,u=0,g=0,d=0,y=0,m=0,q=new s,w=new s,E=this.vertices;if(E.length<3)return t;if(++o>a)return console.warn("quickDecomp: max level ("+a+") reached."),t;for(var O=0;O<this.vertices.length;++O)if(this.isReflex(O)){i.push(this.vertices[O]),l=f=Number.MAX_VALUE;for(var A=0;A<this.vertices.length;++A)e.left(this.at(O-1),this.at(O),this.at(A))&&e.rightOn(this.at(O-1),this.at(O),this.at(A-1))&&(v=n(this.at(O-1),this.at(O),this.at(A),this.at(A-1)),e.right(this.at(O+1),this.at(O),v)&&(u=e.sqdist(this.vertices[O],v))<f&&(f=u,p=v,y=A)),e.left(this.at(O+1),this.at(O),this.at(A+1))&&e.rightOn(this.at(O+1),this.at(O),this.at(A))&&(v=n(this.at(O+1),this.at(O),this.at(A),this.at(A+1)),e.left(this.at(O-1),this.at(O),v)&&(u=e.sqdist(this.vertices[O],v))<l&&(l=u,c=v,d=A));if(y==(d+1)%this.vertices.length)v[0]=(p[0]+c[0])/2,v[1]=(p[1]+c[1])/2,r.push(v),O<d?(q.append(this,O,d+1),q.vertices.push(v),w.vertices.push(v),0!=y&&w.append(this,y,this.vertices.length),w.append(this,0,O+1)):(0!=O&&q.append(this,O,this.vertices.length),q.append(this,0,d+1),q.vertices.push(v),w.vertices.push(v),w.append(this,y,O+1));else{if(y>d&&(d+=this.vertices.length),g=Number.MAX_VALUE,d<y)return t;for(A=y;A<=d;++A)e.leftOn(this.at(O-1),this.at(O),this.at(A))&&e.rightOn(this.at(O+1),this.at(O),this.at(A))&&(u=e.sqdist(this.at(O),this.at(A)))<g&&(g=u,m=A%this.vertices.length);O<m?(q.append(this,O,m+1),0!=m&&w.append(this,m,E.length),w.append(this,0,O+1)):(0!=O&&q.append(this,O,E.length),q.append(this,0,m+1),w.append(this,m,O+1))}return q.vertices.length<w.vertices.length?(q.quickDecomp(t,i,r,h,a,o),w.quickDecomp(t,i,r,h,a,o)):(w.quickDecomp(t,i,r,h,a,o),q.quickDecomp(t,i,r,h,a,o)),t}return t.push(this),t},s.prototype.removeCollinearPoints=function(t){for(var i=0,s=this.vertices.length-1;this.vertices.length>3&&s>=0;--s)e.collinear(this.at(s-1),this.at(s),this.at(s+1),t)&&(this.vertices.splice(s%this.vertices.length,1),s--,i++);return i};
},{"./Line":"OjV7","./Point":"S8qn","./Scalar":"rHYJ"}],"uohH":[function(require,module,exports) {
module.exports={Polygon:require("./Polygon"),Point:require("./Point")};
},{"./Polygon":"xJCm","./Point":"S8qn"}],"Erhf":[function(require,module,exports) {
module.exports=i;var o=require("../math/vec2");function i(t){t=t||{},this.body=null,this.position=o.fromValues(0,0),t.position&&o.copy(this.position,t.position),this.angle=t.angle||0,this.type=t.type||0,this.id=i.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==t.collisionGroup?t.collisionGroup:1,this.collisionResponse=void 0===t.collisionResponse||t.collisionResponse,this.collisionMask=void 0!==t.collisionMask?t.collisionMask:1,this.material=t.material||null,this.area=0,this.sensor=void 0!==t.sensor&&t.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}i.idCounter=0,i.CIRCLE=1,i.PARTICLE=2,i.PLANE=4,i.CONVEX=8,i.LINE=16,i.BOX=32,Object.defineProperty(i,"RECTANGLE",{get:function(){return console.warn("Shape.RECTANGLE is deprecated, use Shape.BOX instead."),i.BOX}}),i.CAPSULE=64,i.HEIGHTFIELD=128,i.prototype.computeMomentOfInertia=function(o){},i.prototype.updateBoundingRadius=function(){},i.prototype.updateArea=function(){},i.prototype.computeAABB=function(o,i,t){},i.prototype.raycast=function(o,i,t,e){};
},{"../math/vec2":"jK4t"}],"lMIv":[function(require,module,exports) {
var r={GetArea:function(r){if(r.length<6)return 0;for(var n=r.length-2,e=0,t=0;t<n;t+=2)e+=(r[t+2]-r[t])*(r[t+1]+r[t+3]);return.5*-(e+=(r[0]-r[n])*(r[n+1]+r[1]))},Triangulate:function(n){var e=n.length>>1;if(e<3)return[];for(var t=[],a=[],i=0;i<e;i++)a.push(i);i=0;for(var u=e;u>3;){var f=a[(i+0)%u],o=a[(i+1)%u],v=a[(i+2)%u],l=n[2*f],c=n[2*f+1],g=n[2*o],h=n[2*o+1],s=n[2*v],p=n[2*v+1],_=!1;if(r._convex(l,c,g,h,s,p)){_=!0;for(var x=0;x<u;x++){var T=a[x];if(T!=f&&T!=o&&T!=v&&r._PointInTriangle(n[2*T],n[2*T+1],l,c,g,h,s,p)){_=!1;break}}}if(_)t.push(f,o,v),a.splice((i+1)%u,1),u--,i=0;else if(i++>3*u)break}return t.push(a[0],a[1],a[2]),t},_PointInTriangle:function(r,n,e,t,a,i,u,f){var o=u-e,v=f-t,l=a-e,c=i-t,g=r-e,h=n-t,s=o*o+v*v,p=o*l+v*c,_=o*g+v*h,x=l*l+c*c,T=l*g+c*h,b=1/(s*x-p*p),k=(x*_-p*T)*b,I=(s*T-p*_)*b;return k>=0&&I>=0&&k+I<1},_convex:function(r,n,e,t,a,i){return(n-t)*(a-e)+(e-r)*(i-t)>=0}};module.exports=r;
},{}],"Ji1u":[function(require,module,exports) {
var e=require("./Shape"),t=require("../math/vec2"),r=require("../math/polyk"),s=require("poly-decomp");function a(r){Array.isArray(arguments[0])&&(r={vertices:arguments[0],axes:arguments[1]},console.warn("The Convex constructor signature has changed. Please use the following format: new Convex({ vertices: [...], ... })")),r=r||{},this.vertices=[];for(var s=void 0!==r.vertices?r.vertices:[],a=0;a<s.length;a++){var i=t.create();t.copy(i,s[a]),this.vertices.push(i)}if(this.axes=[],r.axes)for(a=0;a<r.axes.length;a++){var o=t.create();t.copy(o,r.axes[a]),this.axes.push(o)}else for(a=0;a<this.vertices.length;a++){var n=this.vertices[a],c=this.vertices[(a+1)%this.vertices.length],h=t.create();t.sub(h,c,n),t.rotate90cw(h,h),t.normalize(h,h),this.axes.push(h)}if(this.centerOfMass=t.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,r.type=e.CONVEX,e.call(this,r),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}module.exports=a,a.prototype=new e,a.prototype.constructor=a;var i=t.create(),o=t.create();a.prototype.projectOntoLocalAxis=function(e,r){for(var s,a,o=null,n=null,c=(e=i,0);c<this.vertices.length;c++)s=this.vertices[c],a=t.dot(s,e),(null===o||a>o)&&(o=a),(null===n||a<n)&&(n=a);if(n>o){var h=n;n=o,o=h}t.set(r,n,o)},a.prototype.projectOntoWorldAxis=function(e,r,s,a){var i=o;this.projectOntoLocalAxis(e,a),0!==s?t.rotate(i,e,s):i=e;var n=t.dot(r,i);t.set(a,a[0]+n,a[1]+n)},a.prototype.updateTriangles=function(){this.triangles.length=0;for(var e=[],t=0;t<this.vertices.length;t++){var s=this.vertices[t];e.push(s[0],s[1])}var a=r.Triangulate(e);for(t=0;t<a.length;t+=3){var i=a[t],o=a[t+1],n=a[t+2];this.triangles.push([i,o,n])}};var n=t.create(),c=t.create(),h=t.create(),v=t.create(),u=t.create(),l=t.create(),p=t.create(),g=t.create(),f=t.create();a.prototype.updateCenterOfMass=function(){var e=this.triangles,r=this.vertices,s=this.centerOfMass,i=n,o=h,l=v,p=u,g=c;t.set(s,0,0);for(var f=0,d=0;d!==e.length;d++){var y=e[d];o=r[y[0]],l=r[y[1]],p=r[y[2]];t.centroid(i,o,l,p);var m=a.triangleArea(o,l,p);f+=m,t.scale(g,i,m),t.add(s,s,g)}t.scale(s,s,1/f)},a.prototype.computeMomentOfInertia=function(e){for(var r=0,s=0,a=this.vertices.length,i=a-1,o=0;o<a;i=o,o++){var n=this.vertices[i],c=this.vertices[o],h=Math.abs(t.crossLength(n,c));r+=h*(t.dot(c,c)+t.dot(c,n)+t.dot(n,n)),s+=h}return e/6*(r/s)},a.prototype.updateBoundingRadius=function(){for(var e=this.vertices,r=0,s=0;s!==e.length;s++){var a=t.squaredLength(e[s]);a>r&&(r=a)}this.boundingRadius=Math.sqrt(r)},a.triangleArea=function(e,t,r){return.5*((t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1]))},a.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var e=this.triangles,t=this.vertices,r=0;r!==e.length;r++){var s=e[r],i=t[s[0]],o=t[s[1]],n=t[s[2]],c=a.triangleArea(i,o,n);this.area+=c}},a.prototype.computeAABB=function(e,t,r){e.setFromPoints(this.vertices,t,r,0)};var d=t.create(),y=t.create(),m=t.create();a.prototype.raycast=function(e,r,s,a){var i=d,o=y,n=m,c=this.vertices;t.toLocalFrame(i,r.from,s,a),t.toLocalFrame(o,r.to,s,a);for(var h=c.length,v=0;v<h&&!e.shouldStop(r);v++){var u=c[v],l=c[(v+1)%h],p=t.getLineSegmentsIntersectionFraction(i,o,u,l);p>=0&&(t.sub(n,l,u),t.rotate(n,n,-Math.PI/2+a),t.normalize(n,n),r.reportIntersection(e,p,n,v))}};
},{"./Shape":"Erhf","../math/vec2":"jK4t","../math/polyk":"lMIv","poly-decomp":"uohH"}],"fPko":[function(require,module,exports) {
module.exports=e;var t=require("../math/vec2"),o=require("../collision/RaycastResult"),i=require("../shapes/Shape"),s=require("../collision/AABB");function e(o){o=o||{},this.from=o.from?t.fromValues(o.from[0],o.from[1]):t.create(),this.to=o.to?t.fromValues(o.to[0],o.to[1]):t.create(),this.checkCollisionResponse=void 0===o.checkCollisionResponse||o.checkCollisionResponse,this.skipBackfaces=!!o.skipBackfaces,this.collisionMask=void 0!==o.collisionMask?o.collisionMask:-1,this.collisionGroup=void 0!==o.collisionGroup?o.collisionGroup:-1,this.mode=void 0!==o.mode?o.mode:e.ANY,this.callback=o.callback||function(t){},this.direction=t.create(),this.length=1,this.update()}e.prototype.constructor=e,e.CLOSEST=1,e.ANY=2,e.ALL=4,e.prototype.update=function(){var o=this.direction;t.sub(o,this.to,this.from),this.length=t.length(o),t.normalize(o,o)},e.prototype.intersectBodies=function(t,o){for(var i=0,s=o.length;!t.shouldStop(this)&&i<s;i++){var e=o[i],r=e.getAABB();(r.overlapsRay(this)>=0||r.containsPoint(this.from))&&this.intersectBody(t,e)}};var r=t.create();e.prototype.intersectBody=function(o,i){var s=this.checkCollisionResponse;if(!s||i.collisionResponse)for(var e=r,n=0,a=i.shapes.length;n<a;n++){var c=i.shapes[n];if((!s||c.collisionResponse)&&(0!=(this.collisionGroup&c.collisionMask)&&0!=(c.collisionGroup&this.collisionMask))){t.rotate(e,c.position,i.angle),t.add(e,e,i.position);var h=c.angle+i.angle;if(this.intersectShape(o,c,h,e,i),o.shouldStop(this))break}}},e.prototype.intersectShape=function(t,o,i,s,e){h(this.from,this.direction,s)>o.boundingRadius*o.boundingRadius||(this._currentBody=e,this._currentShape=o,o.raycast(t,this,s,i),this._currentBody=this._currentShape=null)},e.prototype.getAABB=function(o){var i=this.to,s=this.from;t.set(o.lowerBound,Math.min(i[0],s[0]),Math.min(i[1],s[1])),t.set(o.upperBound,Math.max(i[0],s[0]),Math.max(i[1],s[1]))};var n=t.create();e.prototype.reportIntersection=function(o,i,s,r){this.from,this.to;var n=this._currentShape,a=this._currentBody;if(!(this.skipBackfaces&&t.dot(s,this.direction)>0))switch(this.mode){case e.ALL:o.set(s,n,a,i,r),this.callback(o);break;case e.CLOSEST:(i<o.fraction||!o.hasHit())&&o.set(s,n,a,i,r);break;case e.ANY:o.set(s,n,a,i,r)}};var a=t.create(),c=t.create();function h(o,i,s){t.sub(a,s,o);var e=t.dot(a,i);return t.scale(c,i,e),t.add(c,c,o),t.squaredDistance(s,c)}
},{"../math/vec2":"jK4t","../collision/RaycastResult":"rQoL","../shapes/Shape":"Erhf","../collision/AABB":"YFQU"}],"rQoL":[function(require,module,exports) {
var t=require("../math/vec2"),o=require("../collision/Ray");function i(){this.normal=t.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}module.exports=i,i.prototype.reset=function(){t.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},i.prototype.getHitDistance=function(o){return t.distance(o.from,o.to)*this.fraction},i.prototype.hasHit=function(){return-1!==this.fraction},i.prototype.getHitPoint=function(o,i){t.lerp(o,i.from,i.to,this.fraction)},i.prototype.stop=function(){this.isStopped=!0},i.prototype.shouldStop=function(t){return this.isStopped||-1!==this.fraction&&t.mode===o.ANY},i.prototype.set=function(o,i,e,n,s){t.copy(this.normal,o),this.shape=i,this.body=e,this.fraction=n,this.faceIndex=s};
},{"../math/vec2":"jK4t","../collision/Ray":"fPko"}],"V1ry":[function(require,module,exports) {
var t=function(){};module.exports=t,t.prototype={constructor:t,on:function(t,i,e){i.context=e||this,void 0===this._listeners&&(this._listeners={});var r=this._listeners;return void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(i)&&r[t].push(i),this},has:function(t,i){if(void 0===this._listeners)return!1;var e=this._listeners;if(i){if(void 0!==e[t]&&-1!==e[t].indexOf(i))return!0}else if(void 0!==e[t])return!0;return!1},off:function(t,i){if(void 0===this._listeners)return this;var e=this._listeners,r=e[t].indexOf(i);return-1!==r&&e[t].splice(r,1),this},emit:function(t){if(void 0===this._listeners)return this;var i=this._listeners[t.type];if(void 0!==i){t.target=this;for(var e=0,r=i.length;e<r;e++){var s=i[e];s.call(s.context,t)}}return this}};
},{}],"Ko1b":[function(require,module,exports) {
var t=require("../math/vec2"),e=require("poly-decomp"),i=require("../shapes/Convex"),s=require("../collision/RaycastResult"),o=require("../collision/Ray"),a=require("../collision/AABB"),r=require("../events/EventEmitter");function n(e){e=e||{},r.call(this),this.id=e.id||++n._idCounter,this.world=null,this.shapes=[],this.mass=e.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!e.fixedRotation,this.fixedX=!!e.fixedX,this.fixedY=!!e.fixedY,this.massMultiplier=t.create(),this.position=t.fromValues(0,0),e.position&&t.copy(this.position,e.position),this.interpolatedPosition=t.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=t.fromValues(0,0),this.previousAngle=0,this.velocity=t.fromValues(0,0),e.velocity&&t.copy(this.velocity,e.velocity),this.vlambda=t.fromValues(0,0),this.wlambda=0,this.angle=e.angle||0,this.angularVelocity=e.angularVelocity||0,this.force=t.create(),e.force&&t.copy(this.force,e.force),this.angularForce=e.angularForce||0,this.damping="number"==typeof e.damping?e.damping:.1,this.angularDamping="number"==typeof e.angularDamping?e.angularDamping:.1,this.type=n.STATIC,void 0!==e.type?this.type=e.type:e.mass?this.type=n.DYNAMIC:this.type=n.STATIC,this.boundingRadius=0,this.aabb=new a,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.wantsToSleep=!1,this.sleepState=n.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.gravityScale=void 0!==e.gravityScale?e.gravityScale:1,this.collisionResponse=void 0===e.collisionResponse||e.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==e.ccdSpeedThreshold?e.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==e.ccdIterations?e.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}module.exports=n,n.prototype=new r,n.prototype.constructor=n,n._idCounter=0,n.prototype.updateSolveMassProperties=function(){this.sleepState===n.SLEEPING||this.type===n.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},n.prototype.setDensity=function(t){var e=this.getArea();this.mass=e*t,this.updateMassProperties()},n.prototype.getArea=function(){for(var t=0,e=0;e<this.shapes.length;e++)t+=this.shapes[e].area;return t},n.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var h=new a,p=t.create();n.prototype.updateAABB=function(){for(var e=this.shapes,i=e.length,s=p,o=this.angle,a=0;a!==i;a++){var r=e[a],n=r.angle+o;t.rotate(s,r.position,o),t.add(s,s,this.position),r.computeAABB(h,s,n),0===a?this.aabb.copy(h):this.aabb.extend(h)}this.aabbNeedsUpdate=!1},n.prototype.updateBoundingRadius=function(){for(var e=this.shapes,i=e.length,s=0,o=0;o!==i;o++){var a=e[o],r=t.length(a.position),n=a.boundingRadius;r+n>s&&(s=r+n)}this.boundingRadius=s},n.prototype.addShape=function(e,i,s){if(e.body)throw new Error("A shape can only be added to one body.");e.body=this,i?t.copy(e.position,i):t.set(e.position,0,0),e.angle=s||0,this.shapes.push(e),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},n.prototype.removeShape=function(t){var e=this.shapes.indexOf(t);return-1!==e&&(this.shapes.splice(e,1),this.aabbNeedsUpdate=!0,t.body=null,!0)},n.prototype.updateMassProperties=function(){if(this.type===n.STATIC||this.type===n.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var e=this.shapes,i=e.length,s=this.mass/i,o=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var a=0;a<i;a++){var r=e[a],h=t.squaredLength(r.position);o+=r.computeMomentOfInertia(s)+s*h}this.inertia=o,this.invInertia=o>0?1/o:0}this.invMass=1/this.mass,t.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}};var l=t.create();n.prototype.applyForce=function(e,i){if(t.add(this.force,this.force,e),i){var s=t.crossLength(i,e);this.angularForce+=s}};var c=t.create(),d=t.create(),u=t.create();n.prototype.applyForceLocal=function(t,e){e=e||u;var i=c,s=d;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(s,e),this.applyForce(i,s)};var v=t.create();n.prototype.applyImpulse=function(e,i){if(this.type===n.DYNAMIC){var s=v;if(t.scale(s,e,this.invMass),t.multiply(s,this.massMultiplier,s),t.add(this.velocity,s,this.velocity),i){var o=t.crossLength(i,e);o*=this.invInertia,this.angularVelocity+=o}}};var y=t.create(),m=t.create(),f=t.create();n.prototype.applyImpulseLocal=function(t,e){e=e||f;var i=y,s=m;this.vectorToWorldFrame(i,t),this.vectorToWorldFrame(s,e),this.applyImpulse(i,s)},n.prototype.toLocalFrame=function(e,i){t.toLocalFrame(e,i,this.position,this.angle)},n.prototype.toWorldFrame=function(e,i){t.toGlobalFrame(e,i,this.position,this.angle)},n.prototype.vectorToLocalFrame=function(e,i){t.vectorToLocalFrame(e,i,this.angle)},n.prototype.vectorToWorldFrame=function(e,i){t.vectorToGlobalFrame(e,i,this.angle)},n.prototype.fromPolygon=function(s,o){o=o||{};for(var a=this.shapes.length;a>=0;--a)this.removeShape(this.shapes[a]);var r,n=new e.Polygon;if(n.vertices=s,n.makeCCW(),"number"==typeof o.removeCollinearPoints&&n.removeCollinearPoints(o.removeCollinearPoints),void 0===o.skipSimpleCheck&&!n.isSimple())return!1;this.concavePath=n.vertices.slice(0);for(a=0;a<this.concavePath.length;a++){var h=[0,0];t.copy(h,this.concavePath[a]),this.concavePath[a]=h}r=o.optimalDecomp?n.decomp():n.quickDecomp();var p=t.create();for(a=0;a!==r.length;a++){for(var l=new i({vertices:r[a].vertices}),c=0;c!==l.vertices.length;c++){h=l.vertices[c];t.sub(h,h,l.centerOfMass)}t.scale(p,l.centerOfMass,1),l.updateTriangles(),l.updateCenterOfMass(),l.updateBoundingRadius(),this.addShape(l,p)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};var g=t.fromValues(0,0),b=t.fromValues(0,0),S=t.fromValues(0,0),A=t.fromValues(0,0);n.prototype.adjustCenterOfMass=function(){var e=b,i=S,s=A,o=0;t.set(i,0,0);for(var a=0;a!==this.shapes.length;a++){var r=this.shapes[a];t.scale(e,r.position,r.area),t.add(i,i,e),o+=r.area}t.scale(s,i,1/o);for(a=0;a!==this.shapes.length;a++){r=this.shapes[a];t.sub(r.position,r.position,s)}t.add(this.position,this.position,s);for(a=0;this.concavePath&&a<this.concavePath.length;a++)t.sub(this.concavePath[a],this.concavePath[a],s);this.updateMassProperties(),this.updateBoundingRadius()},n.prototype.setZeroForce=function(){t.set(this.force,0,0),this.angularForce=0},n.prototype.resetConstraintVelocity=function(){var e=this.vlambda;t.set(e,0,0),this.wlambda=0},n.prototype.addConstraintVelocity=function(){var e=this,i=e.velocity;t.add(i,i,e.vlambda),e.angularVelocity+=e.wlambda},n.prototype.applyDamping=function(e){if(this.type===n.DYNAMIC){var i=this.velocity;t.scale(i,i,Math.pow(1-this.damping,e)),this.angularVelocity*=Math.pow(1-this.angularDamping,e)}},n.prototype.wakeUp=function(){var t=this.sleepState;this.sleepState=n.AWAKE,this.idleTime=0,t!==n.AWAKE&&this.emit(n.wakeUpEvent)},n.prototype.sleep=function(){this.sleepState=n.SLEEPING,this.angularVelocity=0,this.angularForce=0,t.set(this.velocity,0,0),t.set(this.force,0,0),this.emit(n.sleepEvent)},n.prototype.sleepTick=function(e,i,s){if(this.allowSleep&&this.type!==n.SLEEPING){this.wantsToSleep=!1;this.sleepState;t.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2)>=Math.pow(this.sleepSpeedLimit,2)?(this.idleTime=0,this.sleepState=n.AWAKE):(this.idleTime+=s,this.sleepState=n.SLEEPY),this.idleTime>this.sleepTimeLimit&&(i?this.wantsToSleep=!0:this.sleep())}},n.prototype.overlaps=function(t){return this.world.overlapKeeper.bodiesAreOverlapping(this,t)};var T=t.create(),M=t.create();n.prototype.integrate=function(e){var i=this.invMass,s=this.force,o=this.position,a=this.velocity;t.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*e),t.scale(T,s,e*i),t.multiply(T,this.massMultiplier,T),t.add(a,T,a),this.integrateToTimeOfImpact(e)||(t.scale(M,a,e),t.add(o,o,M),this.fixedRotation||(this.angle+=this.angularVelocity*e)),this.aabbNeedsUpdate=!0};var I=new s,w=new o({mode:o.ALL}),E=t.create(),L=t.create(),P=t.create(),V=t.create();n.prototype.integrateToTimeOfImpact=function(e){if(this.ccdSpeedThreshold<0||t.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;t.normalize(E,this.velocity),t.scale(L,this.velocity,e),t.add(L,L,this.position),t.sub(P,L,this.position);var i,s=this.angularVelocity*e,o=t.length(P),a=1,r=this;if(I.reset(),w.callback=function(e){e.body!==r&&(i=e.body,e.getHitPoint(L,w),t.sub(P,L,r.position),a=t.length(P)/o,e.stop())},t.copy(w.from,this.position),t.copy(w.to,L),w.update(),this.world.raycast(I,w),!i)return!1;var n=this.angle;t.copy(V,this.position);for(var h=0,p=0,l=0,c=a;c>=p&&h<this.ccdIterations;){h++,l=(c-p)/2,t.scale(M,P,a),t.add(this.position,V,M),this.angle=n+s*a,this.updateAABB(),this.aabb.overlaps(i.aabb)&&this.world.narrowphase.bodiesOverlap(this,i)?p=l:c=l}return a=l,t.copy(this.position,V),this.angle=n,t.scale(M,P,a),t.add(this.position,this.position,M),this.fixedRotation||(this.angle+=s*a),!0},n.prototype.getVelocityAtPoint=function(e,i){return t.crossVZ(e,i,this.angularVelocity),t.subtract(e,this.velocity,e),e},n.sleepyEvent={type:"sleepy"},n.sleepEvent={type:"sleep"},n.wakeUpEvent={type:"wakeup"},n.DYNAMIC=1,n.STATIC=2,n.KINEMATIC=4,n.AWAKE=0,n.SLEEPY=1,n.SLEEPING=2;
},{"../math/vec2":"jK4t","poly-decomp":"uohH","../shapes/Convex":"Ji1u","../collision/RaycastResult":"rQoL","../collision/Ray":"fPko","../collision/AABB":"YFQU","../events/EventEmitter":"V1ry"}],"Bdcw":[function(require,module,exports) {
module.exports=s;var t=require("../math/vec2"),i=require("../utils/Utils"),e=require("../objects/Body");function s(t,e,o,a){this.minForce=void 0===o?-Number.MAX_VALUE:o,this.maxForce=void 0===a?Number.MAX_VALUE:a,this.bodyA=t,this.bodyB=e,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.G=new i.ARRAY_TYPE(6);for(var r=0;r<6;r++)this.G[r]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}s.prototype.constructor=s,s.DEFAULT_STIFFNESS=1e6,s.DEFAULT_RELAXATION=4,s.prototype.update=function(){var t=this.stiffness,i=this.relaxation,e=this.timeStep;this.a=4/(e*(1+4*i)),this.b=4*i/(1+4*i),this.epsilon=4/(e*e*t*(1+4*i)),this.needsUpdate=!1},s.prototype.gmult=function(t,i,e,s,o){return t[0]*i[0]+t[1]*i[1]+t[2]*e+t[3]*s[0]+t[4]*s[1]+t[5]*o},s.prototype.computeB=function(t,i,e){var s=this.computeGW();return-this.computeGq()*t-s*i-this.computeGiMf()*e};var o=t.create(),a=t.create();s.prototype.computeGq=function(){var t=this.G,i=this.bodyA,e=this.bodyB,s=(i.position,e.position,i.angle),r=e.angle;return this.gmult(t,o,s,a,r)+this.offset},s.prototype.computeGW=function(){var t=this.G,i=this.bodyA,e=this.bodyB,s=i.velocity,o=e.velocity,a=i.angularVelocity,r=e.angularVelocity;return this.gmult(t,s,a,o,r)+this.relativeVelocity},s.prototype.computeGWlambda=function(){var t=this.G,i=this.bodyA,e=this.bodyB,s=i.vlambda,o=e.vlambda,a=i.wlambda,r=e.wlambda;return this.gmult(t,s,a,o,r)};var r=t.create(),l=t.create();s.prototype.computeGiMf=function(){var i=this.bodyA,e=this.bodyB,s=i.force,o=i.angularForce,a=e.force,n=e.angularForce,u=i.invMassSolve,p=e.invMassSolve,h=i.invInertiaSolve,c=e.invInertiaSolve,v=this.G;return t.scale(r,s,u),t.multiply(r,i.massMultiplier,r),t.scale(l,a,p),t.multiply(l,e.massMultiplier,l),this.gmult(v,r,o*h,l,n*c)},s.prototype.computeGiMGt=function(){var t=this.bodyA,i=this.bodyB,e=t.invMassSolve,s=i.invMassSolve,o=t.invInertiaSolve,a=i.invInertiaSolve,r=this.G;return r[0]*r[0]*e*t.massMultiplier[0]+r[1]*r[1]*e*t.massMultiplier[1]+r[2]*r[2]*o+r[3]*r[3]*s*i.massMultiplier[0]+r[4]*r[4]*s*i.massMultiplier[1]+r[5]*r[5]*a};var n=t.create(),u=t.create(),p=t.create(),h=t.create(),c=t.create(),v=t.create();s.prototype.addToWlambda=function(i){var e=this.bodyA,s=this.bodyB,o=n,a=u,r=p,l=e.invMassSolve,h=s.invMassSolve,c=e.invInertiaSolve,v=s.invInertiaSolve,m=this.G;a[0]=m[0],a[1]=m[1],r[0]=m[3],r[1]=m[4],t.scale(o,a,l*i),t.multiply(o,o,e.massMultiplier),t.add(e.vlambda,e.vlambda,o),e.wlambda+=c*m[2]*i,t.scale(o,r,h*i),t.multiply(o,o,s.massMultiplier),t.add(s.vlambda,s.vlambda,o),s.wlambda+=v*m[5]*i},s.prototype.computeInvC=function(t){return 1/(this.computeGiMGt()+t)};
},{"../math/vec2":"jK4t","../utils/Utils":"vSqo","../objects/Body":"Ko1b"}],"BWCG":[function(require,module,exports) {
var t=require("./Equation"),o=require("../math/vec2");function e(o,e,i){i=i||{},t.call(this,o,e,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}module.exports=e,e.prototype=new t,e.prototype.constructor=e,e.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},e.prototype.setRatio=function(t){var o=this.G;o[2]=t,o[5]=-1,this.ratio=t},e.prototype.setMaxTorque=function(t){this.maxForce=t,this.minForce=-t};
},{"./Equation":"Bdcw","../math/vec2":"jK4t"}],"oqvr":[function(require,module,exports) {
var e=require("../math/vec2"),t=require("../objects/Body");function o(e){this.type=e,this.result=[],this.world=null,this.boundingVolumeType=o.AABB}module.exports=o,o.AABB=1,o.BOUNDING_CIRCLE=2,o.prototype.setWorld=function(e){this.world=e},o.prototype.getCollisionPairs=function(e){};var n=e.create();o.boundingRadiusCheck=function(t,o){e.sub(n,t.position,o.position);var i=e.squaredLength(n),u=t.boundingRadius+o.boundingRadius;return i<=u*u},o.aabbCheck=function(e,t){return e.getAABB().overlaps(t.getAABB())},o.prototype.boundingVolumeCheck=function(e,t){var n;switch(this.boundingVolumeType){case o.BOUNDING_CIRCLE:n=o.boundingRadiusCheck(e,t);break;case o.AABB:n=o.aabbCheck(e,t);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return n},o.canCollide=function(e,o){var n=t.KINEMATIC,i=t.STATIC;return(e.type!==i||o.type!==i)&&(!(e.type===n&&o.type===i||e.type===i&&o.type===n)&&((e.type!==n||o.type!==n)&&((e.sleepState!==t.SLEEPING||o.sleepState!==t.SLEEPING)&&!(e.sleepState===t.SLEEPING&&o.type===i||o.sleepState===t.SLEEPING&&e.type===i))))},o.NAIVE=1,o.SAP=2;
},{"../math/vec2":"jK4t","../objects/Body":"Ko1b"}],"QsEX":[function(require,module,exports) {
var t=require("./Shape"),e=require("../math/vec2");function r(e){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(e={length:arguments[0],radius:arguments[1]},console.warn("The Capsule constructor signature has changed. Please use the following format: new Capsule({ radius: 1, length: 1 })")),e=e||{},this.length=e.length||1,this.radius=e.radius||1,e.type=t.CAPSULE,t.call(this,e)}module.exports=r,r.prototype=new t,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(t){var e=this.radius,r=this.length+e,o=2*e;return t*(o*o+r*r)/12},r.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},r.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var o=e.create();r.prototype.computeAABB=function(t,r,a){var s=this.radius;e.set(o,this.length/2,0),0!==a&&e.rotate(o,o,a),e.set(t.upperBound,Math.max(o[0]+s,-o[0]+s),Math.max(o[1]+s,-o[1]+s)),e.set(t.lowerBound,Math.min(o[0]-s,-o[0]-s),Math.min(o[1]-s,-o[1]-s)),e.add(t.lowerBound,t.lowerBound,r),e.add(t.upperBound,t.upperBound,r)};var a=e.create(),s=e.create(),n=e.create(),i=e.create(),u=e.fromValues(0,1);r.prototype.raycast=function(t,r,o,h){for(var p=r.from,l=r.to,d=(r.direction,a),c=s,f=n,m=i,g=this.length/2,w=0;w<2;w++){var M=this.radius*(2*w-1);if(e.set(f,-g,M),e.set(m,g,M),e.toGlobalFrame(f,f,o,h),e.toGlobalFrame(m,m,o,h),(y=e.getLineSegmentsIntersectionFraction(p,l,f,m))>=0&&(e.rotate(c,u,h),e.scale(c,c,2*w-1),r.reportIntersection(t,y,c,-1),t.shouldStop(r)))return}var v=Math.pow(this.radius,2)+Math.pow(g,2);for(w=0;w<2;w++){e.set(f,g*(2*w-1),0),e.toGlobalFrame(f,f,o,h);var y,b=Math.pow(l[0]-p[0],2)+Math.pow(l[1]-p[1],2),B=2*((l[0]-p[0])*(p[0]-f[0])+(l[1]-p[1])*(p[1]-f[1])),I=Math.pow(p[0]-f[0],2)+Math.pow(p[1]-f[1],2)-Math.pow(this.radius,2);if(!((y=Math.pow(B,2)-4*b*I)<0))if(0===y){if(e.lerp(d,p,l,y),e.squaredDistance(d,o)>v&&(e.sub(c,d,f),e.normalize(c,c),r.reportIntersection(t,y,c,-1),t.shouldStop(r)))return}else{var S=Math.sqrt(y),q=1/(2*b),A=(-B-S)*q,F=(-B+S)*q;if(A>=0&&A<=1&&(e.lerp(d,p,l,A),e.squaredDistance(d,o)>v&&(e.sub(c,d,f),e.normalize(c,c),r.reportIntersection(t,A,c,-1),t.shouldStop(r))))return;if(F>=0&&F<=1&&(e.lerp(d,p,l,F),e.squaredDistance(d,o)>v&&(e.sub(c,d,f),e.normalize(c,c),r.reportIntersection(t,F,c,-1),t.shouldStop(r))))return}}};
},{"./Shape":"Erhf","../math/vec2":"jK4t"}],"A4PI":[function(require,module,exports) {
var t=require("./Shape"),r=require("../math/vec2");function e(r){"number"==typeof arguments[0]&&(r={radius:arguments[0]},console.warn("The Circle constructor signature has changed. Please use the following format: new Circle({ radius: 1 })")),r=r||{},this.radius=r.radius||1,r.type=t.CIRCLE,t.call(this,r)}module.exports=e,e.prototype=new t,e.prototype.constructor=e,e.prototype.computeMomentOfInertia=function(t){var r=this.radius;return t*r*r/2},e.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},e.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},e.prototype.computeAABB=function(t,e,o){var a=this.radius;r.set(t.upperBound,a,a),r.set(t.lowerBound,-a,-a),e&&(r.add(t.lowerBound,t.lowerBound,e),r.add(t.upperBound,t.upperBound,e))};var o=r.create(),a=r.create();e.prototype.raycast=function(t,e,u,i){var n=e.from,s=e.to,p=this.radius,d=Math.pow(s[0]-n[0],2)+Math.pow(s[1]-n[1],2),h=2*((s[0]-n[0])*(n[0]-u[0])+(s[1]-n[1])*(n[1]-u[1])),c=Math.pow(n[0]-u[0],2)+Math.pow(n[1]-u[1],2)-Math.pow(p,2),l=Math.pow(h,2)-4*d*c,f=o,w=a;if(!(l<0))if(0===l)r.lerp(f,n,s,l),r.sub(w,f,u),r.normalize(w,w),e.reportIntersection(t,l,w,-1);else{var m=Math.sqrt(l),y=1/(2*d),B=(-h-m)*y,M=(-h+m)*y;if(B>=0&&B<=1&&(r.lerp(f,n,s,B),r.sub(w,f,u),r.normalize(w,w),e.reportIntersection(t,B,w,-1),t.shouldStop(e)))return;M>=0&&M<=1&&(r.lerp(f,n,s,M),r.sub(w,f,u),r.normalize(w,w),e.reportIntersection(t,M,w,-1))}};
},{"./Shape":"Erhf","../math/vec2":"jK4t"}],"Lh1u":[function(require,module,exports) {
module.exports=t;var e=require("../utils/Utils");function t(t,o,n,i){this.type=n,i=e.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=t,this.bodyB=o,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(t&&t.wakeUp(),o&&o.wakeUp())}t.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},t.DISTANCE=1,t.GEAR=2,t.LOCK=3,t.PRISMATIC=4,t.REVOLUTE=5,t.prototype.setStiffness=function(e){for(var t=this.equations,o=0;o!==t.length;o++){var n=t[o];n.stiffness=e,n.needsUpdate=!0}},t.prototype.setRelaxation=function(e){for(var t=this.equations,o=0;o!==t.length;o++){var n=t[o];n.relaxation=e,n.needsUpdate=!0}};
},{"../utils/Utils":"vSqo"}],"Xmyq":[function(require,module,exports) {
var t=require("./Equation"),i=require("../math/vec2");function o(o,e){t.call(this,o,e,0,Number.MAX_VALUE),this.contactPointA=i.create(),this.penetrationVec=i.create(),this.contactPointB=i.create(),this.normalA=i.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}module.exports=o,o.prototype=new t,o.prototype.constructor=o,o.prototype.computeB=function(t,o,e){var s,n,c=this.bodyA,r=this.bodyB,h=this.contactPointA,a=this.contactPointB,u=c.position,p=r.position,l=this.penetrationVec,A=this.normalA,m=this.G,y=i.crossLength(h,A),d=i.crossLength(a,A);return m[0]=-A[0],m[1]=-A[1],m[2]=-y,m[3]=A[0],m[4]=A[1],m[5]=d,i.add(l,p,a),i.sub(l,l,u),i.sub(l,l,h),this.firstImpact&&0!==this.restitution?(n=0,s=1/o*(1+this.restitution)*this.computeGW()):(n=i.dot(A,l)+this.offset,s=this.computeGW()),-n*t-s*o-e*this.computeGiMf()};var e=i.create(),s=i.create(),n=i.create();o.prototype.getVelocityAlongNormal=function(){return this.bodyA.getVelocityAtPoint(e,this.contactPointA),this.bodyB.getVelocityAtPoint(s,this.contactPointB),i.subtract(n,e,s),i.dot(this.normalA,n)};
},{"./Equation":"Bdcw","../math/vec2":"jK4t"}],"ajVA":[function(require,module,exports) {
function t(t){t=t||{},this.objects=[],void 0!==t.size&&this.resize(t.size)}module.exports=t,t.prototype.resize=function(t){for(var e=this.objects;e.length>t;)e.pop();for(;e.length<t;)e.push(this.create());return this},t.prototype.get=function(){var t=this.objects;return t.length?t.pop():this.create()},t.prototype.release=function(t){return this.destroy(t),this.objects.push(t),this};
},{}],"kuQI":[function(require,module,exports) {
var t=require("../equations/ContactEquation"),o=require("./Pool");function e(){o.apply(this,arguments)}module.exports=e,e.prototype=new o,e.prototype.constructor=e,e.prototype.create=function(){return new t},e.prototype.destroy=function(t){return t.bodyA=t.bodyB=null,this};
},{"../equations/ContactEquation":"Xmyq","./Pool":"ajVA"}],"imEs":[function(require,module,exports) {
function i(o){this.id=o||i.idCounter++}module.exports=i,i.idCounter=0;
},{}],"oPge":[function(require,module,exports) {
var i=require("./Material"),t=require("../equations/Equation");function e(r,o,s){if(s=s||{},!(r instanceof i&&o instanceof i))throw new Error("First two arguments must be Material instances.");this.id=e.idCounter++,this.materialA=r,this.materialB=o,this.friction=void 0!==s.friction?Number(s.friction):.3,this.restitution=void 0!==s.restitution?Number(s.restitution):0,this.stiffness=void 0!==s.stiffness?Number(s.stiffness):t.DEFAULT_STIFFNESS,this.relaxation=void 0!==s.relaxation?Number(s.relaxation):t.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==s.frictionStiffness?Number(s.frictionStiffness):t.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==s.frictionRelaxation?Number(s.frictionRelaxation):t.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==s.surfaceVelocity?Number(s.surfaceVelocity):0,this.contactSkinSize=.005}module.exports=e,e.idCounter=0;
},{"./Material":"imEs","../equations/Equation":"Bdcw"}],"ceTU":[function(require,module,exports) {
var t=require("./Constraint"),e=require("../equations/Equation"),i=require("../math/vec2"),o=require("../utils/Utils");function r(r,a,s){s=o.defaults(s,{localAnchorA:[0,0],localAnchorB:[0,0]}),t.call(this,r,a,t.DISTANCE,s),this.localAnchorA=i.fromValues(s.localAnchorA[0],s.localAnchorA[1]),this.localAnchorB=i.fromValues(s.localAnchorB[0],s.localAnchorB[1]);var n,c=this.localAnchorA,h=this.localAnchorB;if(this.distance=0,"number"==typeof s.distance)this.distance=s.distance;else{var l=i.create(),u=i.create(),p=i.create();i.rotate(l,c,r.angle),i.rotate(u,h,a.angle),i.add(p,a.position,u),i.sub(p,p,l),i.sub(p,p,r.position),this.distance=i.length(p)}n=void 0===s.maxForce?Number.MAX_VALUE:s.maxForce;var m=new e(r,a,-n,n);this.equations=[m],this.maxForce=n;p=i.create();var d=i.create(),A=i.create(),b=this;m.computeGq=function(){var t=this.bodyA,e=this.bodyB,o=t.position,r=e.position;return i.rotate(d,c,t.angle),i.rotate(A,h,e.angle),i.add(p,r,A),i.sub(p,p,d),i.sub(p,p,o),i.length(p)-b.distance},this.setMaxForce(n),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}module.exports=r,r.prototype=new t,r.prototype.constructor=r;var a=i.create(),s=i.create(),n=i.create();r.prototype.update=function(){var t=this.equations[0],e=this.bodyA,o=this.bodyB,r=(this.distance,e.position),c=o.position,h=this.equations[0],l=t.G;i.rotate(s,this.localAnchorA,e.angle),i.rotate(n,this.localAnchorB,o.angle),i.add(a,c,n),i.sub(a,a,s),i.sub(a,a,r),this.position=i.length(a);var u=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(h.maxForce=0,h.minForce=-this.maxForce,this.distance=this.upperLimit,u=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(h.maxForce=this.maxForce,h.minForce=0,this.distance=this.lowerLimit,u=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||u){h.enabled=!0,i.normalize(a,a);var p=i.crossLength(s,a),m=i.crossLength(n,a);l[0]=-a[0],l[1]=-a[1],l[2]=-p,l[3]=a[0],l[4]=a[1],l[5]=m}else h.enabled=!1},r.prototype.setMaxForce=function(t){var e=this.equations[0];e.minForce=-t,e.maxForce=t},r.prototype.getMaxForce=function(){return this.equations[0].maxForce};
},{"./Constraint":"Lh1u","../equations/Equation":"Bdcw","../math/vec2":"jK4t","../utils/Utils":"vSqo"}],"KIQm":[function(require,module,exports) {
var t=require("../math/vec2"),o=require("./Equation"),i=require("../utils/Utils");function e(i,e,c){o.call(this,i,e,-c,c),this.contactPointA=t.create(),this.contactPointB=t.create(),this.t=t.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}module.exports=e,e.prototype=new o,e.prototype.constructor=e,e.prototype.setSlipForce=function(t){this.maxForce=t,this.minForce=-t},e.prototype.getSlipForce=function(){return this.maxForce},e.prototype.computeB=function(o,i,e){this.bodyA,this.bodyB;var c=this.contactPointA,r=this.contactPointB,s=this.t,n=this.G;return n[0]=-s[0],n[1]=-s[1],n[2]=-t.crossLength(c,s),n[3]=s[0],n[4]=s[1],n[5]=t.crossLength(r,s),-this.computeGW()*i-e*this.computeGiMf()};
},{"../math/vec2":"jK4t","./Equation":"Bdcw","../utils/Utils":"vSqo"}],"HAB3":[function(require,module,exports) {
var o=require("../equations/FrictionEquation"),t=require("./Pool");function r(){t.apply(this,arguments)}module.exports=r,r.prototype=new t,r.prototype.constructor=r,r.prototype.create=function(){return new o},r.prototype.destroy=function(o){return o.bodyA=o.bodyB=null,this};
},{"../equations/FrictionEquation":"KIQm","./Pool":"ajVA"}],"krUx":[function(require,module,exports) {
var t=require("./Constraint"),e=require("../equations/Equation"),o=require("../equations/AngleLockEquation"),i=require("../math/vec2");function a(e,i,a){a=a||{},t.call(this,e,i,t.GEAR,a),this.ratio=void 0!==a.ratio?a.ratio:1,this.angle=void 0!==a.angle?a.angle:i.angle-this.ratio*e.angle,a.angle=this.angle,a.ratio=this.ratio,this.equations=[new o(e,i,a)],void 0!==a.maxTorque&&this.setMaxTorque(a.maxTorque)}module.exports=a,a.prototype=new t,a.prototype.constructor=a,a.prototype.update=function(){var t=this.equations[0];t.ratio!==this.ratio&&t.setRatio(this.ratio),t.angle=this.angle},a.prototype.setMaxTorque=function(t){this.equations[0].setMaxTorque(t)},a.prototype.getMaxTorque=function(t){return this.equations[0].maxForce};
},{"./Constraint":"Lh1u","../equations/Equation":"Bdcw","../equations/AngleLockEquation":"BWCG","../math/vec2":"jK4t"}],"meaD":[function(require,module,exports) {
var t=require("../utils/Utils"),o=require("../events/EventEmitter");function e(t,e){t=t||{},o.call(this),this.type=e,this.equations=[],this.equationSortFunction=t.equationSortFunction||!1}module.exports=e,e.prototype=new o,e.prototype.constructor=e,e.prototype.solve=function(t,o){throw new Error("Solver.solve should be implemented by subclasses!")};var i={bodies:[]};e.prototype.solveIsland=function(t,o){this.removeAllEquations(),o.equations.length&&(this.addEquations(o.equations),i.bodies.length=0,o.getBodies(i.bodies),i.bodies.length&&this.solve(t,i))},e.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},e.prototype.addEquation=function(t){t.enabled&&this.equations.push(t)},e.prototype.addEquations=function(t){for(var o=0,e=t.length;o!==e;o++){var i=t[o];i.enabled&&this.equations.push(i)}},e.prototype.removeEquation=function(t){var o=this.equations.indexOf(t);-1!==o&&this.equations.splice(o,1)},e.prototype.removeAllEquations=function(){this.equations.length=0},e.GS=1,e.ISLAND=2;
},{"../utils/Utils":"vSqo","../events/EventEmitter":"V1ry"}],"AkER":[function(require,module,exports) {
var t=require("../math/vec2"),i=require("./Solver"),e=require("../utils/Utils"),r=require("../equations/FrictionEquation");function a(t){i.call(this,t,i.GS),t=t||{},this.iterations=t.iterations||10,this.tolerance=t.tolerance||1e-7,this.arrayStep=30,this.lambda=new e.ARRAY_TYPE(this.arrayStep),this.Bs=new e.ARRAY_TYPE(this.arrayStep),this.invCs=new e.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=void 0!==t.frictionIterations?0:t.frictionIterations,this.usedIterations=0}function o(t){for(var i=t.length;i--;)t[i]=0}module.exports=a,a.prototype=new i,a.prototype.constructor=a,a.prototype.solve=function(i,s){this.sortEquations();var n=0,h=this.iterations,u=this.frictionIterations,l=this.equations,c=l.length,p=Math.pow(this.tolerance*c,2),f=s.bodies,d=s.bodies.length,v=(t.add,t.set,this.useZeroRHS),m=this.lambda;if(this.usedIterations=0,c)for(var q=0;q!==d;q++){f[q].updateSolveMassProperties()}m.length<c&&(m=this.lambda=new e.ARRAY_TYPE(c+this.arrayStep),this.Bs=new e.ARRAY_TYPE(c+this.arrayStep),this.invCs=new e.ARRAY_TYPE(c+this.arrayStep)),o(m);var E,R,S=this.invCs,b=this.Bs;for(m=this.lambda,q=0;q!==l.length;q++){var y;((y=l[q]).timeStep!==i||y.needsUpdate)&&(y.timeStep=i,y.update()),b[q]=y.computeB(y.a,y.b,i),S[q]=y.computeInvC(y.epsilon)}if(0!==c){for(q=0;q!==d;q++){f[q].resetConstraintVelocity()}if(u){for(n=0;n!==u;n++){for(E=0,R=0;R!==c;R++){y=l[R];var A=a.iterateEquation(R,y,y.epsilon,b,S,m,v,i,n);E+=Math.abs(A)}if(this.usedIterations++,E*E<=p)break}for(a.updateMultipliers(l,m,1/i),R=0;R!==c;R++){var Y=l[R];if(Y instanceof r){for(var I=0,g=0;g!==Y.contactEquations.length;g++)I+=Y.contactEquations[g].multiplier;I*=Y.frictionCoefficient/Y.contactEquations.length,Y.maxForce=I,Y.minForce=-I}}}for(n=0;n!==h;n++){for(E=0,R=0;R!==c;R++){y=l[R];A=a.iterateEquation(R,y,y.epsilon,b,S,m,v,i,n);E+=Math.abs(A)}if(this.usedIterations++,E*E<=p)break}for(q=0;q!==d;q++)f[q].addConstraintVelocity();a.updateMultipliers(l,m,1/i)}},a.updateMultipliers=function(t,i,e){for(var r=t.length;r--;)t[r].multiplier=i[r]*e},a.iterateEquation=function(t,i,e,r,a,o,s,n,h){var u=r[t],l=a[t],c=o[t],p=i.computeGWlambda(),f=i.maxForce,d=i.minForce;s&&(u=0);var v=l*(u-p-e*c),m=c+v;return m<d*n?v=d*n-c:m>f*n&&(v=f*n-c),o[t]+=v,i.addToWlambda(v),v};
},{"../math/vec2":"jK4t","./Solver":"meaD","../utils/Utils":"vSqo","../equations/FrictionEquation":"KIQm"}],"rs8L":[function(require,module,exports) {
var e=require("./Shape"),t=require("../math/vec2"),i=require("../utils/Utils");function n(t){if(Array.isArray(arguments[0])){if(t={heights:arguments[0]},"object"==typeof arguments[1])for(var i in arguments[1])t[i]=arguments[1][i];console.warn("The Heightfield constructor signature has changed. Please use the following format: new Heightfield({ heights: [...], ... })")}t=t||{},this.heights=t.heights?t.heights.slice(0):[],this.maxValue=t.maxValue||null,this.minValue=t.minValue||null,this.elementWidth=t.elementWidth||.1,void 0!==t.maxValue&&void 0!==t.minValue||this.updateMaxMinValues(),t.type=e.HEIGHTFIELD,e.call(this,t)}module.exports=n,n.prototype=new e,n.prototype.constructor=n,n.prototype.updateMaxMinValues=function(){for(var e=this.heights,t=e[0],i=e[0],n=0;n!==e.length;n++){var r=e[n];r>t&&(t=r),r<i&&(i=r)}this.maxValue=t,this.minValue=i},n.prototype.computeMomentOfInertia=function(e){return Number.MAX_VALUE},n.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},n.prototype.updateArea=function(){for(var e=this.heights,t=0,i=0;i<e.length-1;i++)t+=(e[i]+e[i+1])/2*this.elementWidth;this.area=t};var r=[t.create(),t.create(),t.create(),t.create()];n.prototype.computeAABB=function(e,i,n){t.set(r[0],0,this.maxValue),t.set(r[1],this.elementWidth*this.heights.length,this.maxValue),t.set(r[2],this.elementWidth*this.heights.length,this.minValue),t.set(r[3],0,this.minValue),e.setFromPoints(r,i,n)},n.prototype.getLineSegment=function(e,i,n){var r=this.heights,a=this.elementWidth;t.set(e,n*a,r[n]),t.set(i,(n+1)*a,r[n+1])},n.prototype.getSegmentIndex=function(e){return Math.floor(e[0]/this.elementWidth)},n.prototype.getClampedSegmentIndex=function(e){var t=this.getSegmentIndex(e);return t=Math.min(this.heights.length,Math.max(t,0))};var a=t.create(),h=t.create(),o=t.create(),s=t.create(),u=t.create(),l=t.create(),m=t.fromValues(0,1);function g(e,t,i,n,r){var a,h,o,s,u,l;if(a=i[0]-t[0],h=i[1]-t[1],o=r[0]-n[0],s=r[1]-n[1],u=(-h*(t[0]-n[0])+a*(t[1]-n[1]))/(-o*h+a*s),l=(o*(t[1]-n[1])-s*(t[0]-n[0]))/(-o*h+a*s),u>=0&&u<=1&&l>=0&&l<=1){var m=t[0]+l*a,g=t[1]+l*h;return e[0]=m,e[1]=g,l}return-1}n.prototype.raycast=function(e,i,n,r){var a=i.from,m=i.to,g=(i.direction,h),c=o,p=s,d=u,f=l;t.toLocalFrame(d,a,n,r),t.toLocalFrame(f,m,n,r);var v=this.getClampedSegmentIndex(d),V=this.getClampedSegmentIndex(f);if(v>V){var y=v;v=V,V=y}for(var x=0;x<this.heights.length-1;x++){this.getLineSegment(c,p,x);var I=t.getLineSegmentsIntersectionFraction(d,f,c,p);if(I>=0&&(t.sub(g,p,c),t.rotate(g,g,r+Math.PI/2),t.normalize(g,g),i.reportIntersection(e,I,g,-1),e.shouldStop(i)))return}};
},{"./Shape":"Erhf","../math/vec2":"jK4t","../utils/Utils":"vSqo"}],"TmGq":[function(require,module,exports) {
var t=require("./Shape"),e=require("../math/vec2");function o(e){"number"==typeof arguments[0]&&(e={length:arguments[0]},console.warn("The Line constructor signature has changed. Please use the following format: new Line({ length: 1, ... })")),e=e||{},this.length=e.length||1,e.type=t.LINE,t.call(this,e)}module.exports=o,o.prototype=new t,o.prototype.constructor=o,o.prototype.computeMomentOfInertia=function(t){return t*Math.pow(this.length,2)/12},o.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var r=[e.create(),e.create()];o.prototype.computeAABB=function(t,o,n){var a=this.length/2;e.set(r[0],-a,0),e.set(r[1],a,0),t.setFromPoints(r,o,n,0)};var n=e.create(),a=e.create(),i=e.create(),s=e.create(),c=e.fromValues(0,1);o.prototype.raycast=function(t,o,r,n){var h=o.from,u=o.to,p=i,l=s,g=this.length/2;e.set(p,-g,0),e.set(l,g,0),e.toGlobalFrame(p,p,r,n),e.toGlobalFrame(l,l,r,n);var m=e.getLineSegmentsIntersectionFraction(p,l,h,u);if(m>=0){var f=a;e.rotate(f,c,n),o.reportIntersection(t,m,f,-1)}};
},{"./Shape":"Erhf","../math/vec2":"jK4t"}],"Z6xo":[function(require,module,exports) {
var t=require("./Constraint"),e=require("../math/vec2"),o=require("../equations/Equation");function a(a,s,l){l=l||{},t.call(this,a,s,t.LOCK,l);var n=void 0===l.maxForce?Number.MAX_VALUE:l.maxForce,i=(l.localAngleB,new o(a,s,-n,n)),r=new o(a,s,-n,n),c=new o(a,s,-n,n),u=e.create(),f=e.create(),h=this;i.computeGq=function(){return e.rotate(u,h.localOffsetB,a.angle),e.sub(f,s.position,a.position),e.sub(f,f,u),f[0]},r.computeGq=function(){return e.rotate(u,h.localOffsetB,a.angle),e.sub(f,s.position,a.position),e.sub(f,f,u),f[1]};var p=e.create(),g=e.create();c.computeGq=function(){return e.rotate(p,h.localOffsetB,s.angle-h.localAngleB),e.scale(p,p,-1),e.sub(f,a.position,s.position),e.add(f,f,p),e.rotate(g,p,-Math.PI/2),e.normalize(g,g),e.dot(f,g)},this.localOffsetB=e.create(),l.localOffsetB?e.copy(this.localOffsetB,l.localOffsetB):(e.sub(this.localOffsetB,s.position,a.position),e.rotate(this.localOffsetB,this.localOffsetB,-a.angle)),this.localAngleB=0,"number"==typeof l.localAngleB?this.localAngleB=l.localAngleB:this.localAngleB=s.angle-a.angle,this.equations.push(i,r,c),this.setMaxForce(n)}module.exports=a,a.prototype=new t,a.prototype.constructor=a,a.prototype.setMaxForce=function(t){for(var e=this.equations,o=0;o<this.equations.length;o++)e[o].maxForce=t,e[o].minForce=-t},a.prototype.getMaxForce=function(){return this.equations[0].maxForce};var s=e.create(),l=e.create(),n=e.create(),i=e.fromValues(1,0),r=e.fromValues(0,1);a.prototype.update=function(){var t=this.equations[0],o=this.equations[1],a=this.equations[2],c=this.bodyA,u=this.bodyB;e.rotate(s,this.localOffsetB,c.angle),e.rotate(l,this.localOffsetB,u.angle-this.localAngleB),e.scale(l,l,-1),e.rotate(n,l,Math.PI/2),e.normalize(n,n),t.G[0]=-1,t.G[1]=0,t.G[2]=-e.crossLength(s,i),t.G[3]=1,o.G[0]=0,o.G[1]=-1,o.G[2]=-e.crossLength(s,r),o.G[4]=1,a.G[0]=-n[0],a.G[1]=-n[1],a.G[3]=n[0],a.G[4]=n[1],a.G[5]=e.crossLength(l,n)};
},{"./Constraint":"Lh1u","../math/vec2":"jK4t","../equations/Equation":"Bdcw"}],"MDj9":[function(require,module,exports) {
var t=require("./Utils");function e(){this.data={},this.keys=[]}module.exports=e,e.prototype.getKey=function(t,e){return(0|(t|=0))==(0|(e|=0))?-1:0|((0|t)>(0|e)?t<<16|65535&e:e<<16|65535&t)},e.prototype.getByKey=function(t){return t|=0,this.data[t]},e.prototype.get=function(t,e){return this.data[this.getKey(t,e)]},e.prototype.set=function(t,e,r){if(!r)throw new Error("No data!");var o=this.getKey(t,e);return this.data[o]||this.keys.push(o),this.data[o]=r,o},e.prototype.reset=function(){for(var t=this.data,e=this.keys,r=e.length;r--;)delete t[e[r]];e.length=0},e.prototype.copy=function(e){this.reset(),t.appendArray(this.keys,e.keys);for(var r=e.keys.length;r--;){var o=e.keys[r];this.data[o]=e.data[o]}};
},{"./Utils":"vSqo"}],"k1Qp":[function(require,module,exports) {
var t=require("../math/vec2"),e=require("./Shape"),o=require("./Convex");function r(r){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(r={width:arguments[0],height:arguments[1]},console.warn("The Rectangle has been renamed to Box and its constructor signature has changed. Please use the following format: new Box({ width: 1, height: 1, ... })")),r=r||{};var i=this.width=r.width||1,h=this.height=r.height||1,a=[t.fromValues(-i/2,-h/2),t.fromValues(i/2,-h/2),t.fromValues(i/2,h/2),t.fromValues(-i/2,h/2)],s=[t.fromValues(1,0),t.fromValues(0,1)];r.vertices=a,r.axes=s,r.type=e.BOX,o.call(this,r)}module.exports=r,r.prototype=new o,r.prototype.constructor=r,r.prototype.computeMomentOfInertia=function(t){var e=this.width,o=this.height;return t*(o*o+e*e)/12},r.prototype.updateBoundingRadius=function(){var t=this.width,e=this.height;this.boundingRadius=Math.sqrt(t*t+e*e)/2};var i=t.create(),h=t.create(),a=t.create(),s=t.create();r.prototype.computeAABB=function(t,e,o){t.setFromPoints(this.vertices,e,o,0)},r.prototype.updateArea=function(){this.area=this.width*this.height};
},{"../math/vec2":"jK4t","./Shape":"Erhf","./Convex":"Ji1u"}],"RcXI":[function(require,module,exports) {
var t=require("../math/vec2"),o=t.sub,n=t.add,i=t.dot,e=require("../utils/Utils"),a=require("../utils/ContactEquationPool"),r=require("../utils/FrictionEquationPool"),c=require("../utils/TupleDictionary"),s=require("../equations/Equation"),l=require("../equations/ContactEquation"),u=require("../equations/FrictionEquation"),h=require("../shapes/Circle"),p=require("../shapes/Convex"),f=require("../shapes/Shape"),v=require("../objects/Body"),A=require("../shapes/Box");module.exports=O;var P=t.fromValues(0,1),d=t.fromValues(0,0),E=t.fromValues(0,0),m=t.fromValues(0,0),F=t.fromValues(0,0),y=t.fromValues(0,0),q=t.fromValues(0,0),C=t.fromValues(0,0),B=t.fromValues(0,0),b=t.fromValues(0,0),g=t.fromValues(0,0),L=t.fromValues(0,0),V=t.fromValues(0,0),x=t.fromValues(0,0),R=t.fromValues(0,0),I=t.fromValues(0,0),S=t.fromValues(0,0),N=t.fromValues(0,0),w=t.fromValues(0,0),z=[];function O(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new a({size:32}),this.frictionEquationPool=new r({size:64}),this.restitution=0,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.frictionStiffness=s.DEFAULT_STIFFNESS,this.frictionRelaxation=s.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new c,this.contactSkinSize=.01}var X=t.create(),T=t.create();function U(o,n){t.set(o.vertices[0],.5*-n.length,-n.radius),t.set(o.vertices[1],.5*n.length,-n.radius),t.set(o.vertices[2],.5*n.length,n.radius),t.set(o.vertices[3],.5*-n.length,n.radius)}O.prototype.bodiesOverlap=function(t,o){for(var n=X,i=T,e=0,a=t.shapes.length;e!==a;e++){var r=t.shapes[e];t.toWorldFrame(n,r.position);for(var c=0,s=o.shapes.length;c!==s;c++){var l=o.shapes[c];if(o.toWorldFrame(i,l.position),this[r.type|l.type](t,r,n,r.angle+t.angle,o,l,i,l.angle+o.angle,!0))return!0}}return!1},O.prototype.collidedLastStep=function(t,o){var n=0|t.id,i=0|o.id;return!!this.collidingBodiesLastStep.get(n,i)},O.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var t=this.contactEquations,o=t.length;o--;){var n=t[o],i=n.bodyA.id,e=n.bodyB.id;this.collidingBodiesLastStep.set(i,e,!0)}for(var a=this.contactEquations,r=this.frictionEquations,c=0;c<a.length;c++)this.contactEquationPool.release(a[c]);for(c=0;c<r.length;c++)this.frictionEquationPool.release(r[c]);this.contactEquations.length=this.frictionEquations.length=0},O.prototype.createContactEquation=function(t,o,n,i){var e=this.contactEquationPool.get();return e.bodyA=t,e.bodyB=o,e.shapeA=n,e.shapeB=i,e.restitution=this.restitution,e.firstImpact=!this.collidedLastStep(t,o),e.stiffness=this.stiffness,e.relaxation=this.relaxation,e.needsUpdate=!0,e.enabled=this.enabledEquations,e.offset=this.contactSkinSize,e},O.prototype.createFrictionEquation=function(t,o,n,i){var e=this.frictionEquationPool.get();return e.bodyA=t,e.bodyB=o,e.shapeA=n,e.shapeB=i,e.setSlipForce(this.slipForce),e.frictionCoefficient=this.frictionCoefficient,e.relativeVelocity=this.surfaceVelocity,e.enabled=this.enabledEquations,e.needsUpdate=!0,e.stiffness=this.frictionStiffness,e.relaxation=this.frictionRelaxation,e.contactEquations.length=0,e},O.prototype.createFrictionFromContact=function(o){var n=this.createFrictionEquation(o.bodyA,o.bodyB,o.shapeA,o.shapeB);return t.copy(n.contactPointA,o.contactPointA),t.copy(n.contactPointB,o.contactPointB),t.rotate90cw(n.t,o.normalA),n.contactEquations.push(o),n},O.prototype.createFrictionFromAverage=function(o){var n=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(n.bodyA,n.bodyB,n.shapeA,n.shapeB),e=n.bodyA;n.bodyB;t.set(i.contactPointA,0,0),t.set(i.contactPointB,0,0),t.set(i.t,0,0);for(var a=0;a!==o;a++)(n=this.contactEquations[this.contactEquations.length-1-a]).bodyA===e?(t.add(i.t,i.t,n.normalA),t.add(i.contactPointA,i.contactPointA,n.contactPointA),t.add(i.contactPointB,i.contactPointB,n.contactPointB)):(t.sub(i.t,i.t,n.normalA),t.add(i.contactPointA,i.contactPointA,n.contactPointB),t.add(i.contactPointB,i.contactPointB,n.contactPointA)),i.contactEquations.push(n);var r=1/o;return t.scale(i.contactPointA,i.contactPointA,r),t.scale(i.contactPointB,i.contactPointB,r),t.normalize(i.t,i.t),t.rotate90cw(i.t,i.t),i},O.prototype[f.LINE|f.CONVEX]=O.prototype.convexLine=function(t,o,n,i,e,a,r,c,s){return!s&&0},O.prototype[f.LINE|f.BOX]=O.prototype.lineBox=function(t,o,n,i,e,a,r,c,s){return!s&&0};var M=new A({width:1,height:1}),D=t.create();O.prototype[f.CAPSULE|f.CONVEX]=O.prototype[f.CAPSULE|f.BOX]=O.prototype.convexCapsule=function(o,n,i,e,a,r,c,s,l){var u=D;t.set(u,r.length/2,0),t.rotate(u,u,s),t.add(u,u,c);var h=this.circleConvex(a,r,u,s,o,n,i,e,l,r.radius);t.set(u,-r.length/2,0),t.rotate(u,u,s),t.add(u,u,c);var p=this.circleConvex(a,r,u,s,o,n,i,e,l,r.radius);if(l&&(h||p))return!0;var f=M;return U(f,r),this.convexConvex(o,n,i,e,a,f,c,s,l)+h+p},O.prototype[f.CAPSULE|f.LINE]=O.prototype.lineCapsule=function(t,o,n,i,e,a,r,c,s){return!s&&0};var H=t.create(),j=t.create(),_=new A({width:1,height:1});O.prototype[f.CAPSULE|f.CAPSULE]=O.prototype.capsuleCapsule=function(o,n,i,e,a,r,c,s,l){for(var u=H,h=j,p=0,f=0;f<2;f++){t.set(u,(0===f?-1:1)*n.length/2,0),t.rotate(u,u,e),t.add(u,u,i);for(var v=0;v<2;v++){t.set(h,(0===v?-1:1)*r.length/2,0),t.rotate(h,h,s),t.add(h,h,c),this.enableFrictionReduction&&(E=this.enableFriction,this.enableFriction=!1);var A=this.circleCircle(o,n,u,e,a,r,h,s,l,n.radius,r.radius);if(this.enableFrictionReduction&&(this.enableFriction=E),l&&A)return!0;p+=A}}this.enableFrictionReduction&&(E=this.enableFriction,this.enableFriction=!1);var P=_;U(P,n);var d=this.convexCapsule(o,P,i,e,a,r,c,s,l);if(this.enableFrictionReduction&&(this.enableFriction=E),l&&d)return!0;if(p+=d,this.enableFrictionReduction){var E=this.enableFriction;this.enableFriction=!1}U(P,r);var m=this.convexCapsule(a,P,c,s,o,n,i,e,l);return this.enableFrictionReduction&&(this.enableFriction=E),!(!l||!m)||(p+=m,this.enableFrictionReduction&&p&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(p)),p)},O.prototype[f.LINE|f.LINE]=O.prototype.lineLine=function(t,o,n,i,e,a,r,c,s){return!s&&0},O.prototype[f.PLANE|f.LINE]=O.prototype.planeLine=function(e,a,r,c,s,l,u,h,p){var f=d,v=E,A=m,g=F,L=y,V=q,x=C,R=B,I=b,S=z,N=0;t.set(f,-l.length/2,0),t.set(v,l.length/2,0),t.rotate(A,f,h),t.rotate(g,v,h),n(A,A,u),n(g,g,u),t.copy(f,A),t.copy(v,g),o(L,v,f),t.normalize(V,L),t.rotate90cw(I,V),t.rotate(R,P,c),S[0]=f,S[1]=v;for(var w=0;w<S.length;w++){var O=S[w];o(x,O,r);var X=i(x,R);if(X<0){if(p)return!0;var T=this.createContactEquation(e,s,a,l);N++,t.copy(T.normalA,R),t.normalize(T.normalA,T.normalA),t.scale(x,R,X),o(T.contactPointA,O,x),o(T.contactPointA,T.contactPointA,e.position),o(T.contactPointB,O,u),n(T.contactPointB,T.contactPointB,u),o(T.contactPointB,T.contactPointB,s.position),this.contactEquations.push(T),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T))}}return!p&&(this.enableFrictionReduction||N&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(N)),N)},O.prototype[f.PARTICLE|f.CAPSULE]=O.prototype.particleCapsule=function(t,o,n,i,e,a,r,c,s){return this.circleLine(t,o,n,i,e,a,r,c,s,a.radius,0)},O.prototype[f.CIRCLE|f.LINE]=O.prototype.circleLine=function(e,a,r,c,s,l,u,h,p,f,v){f=f||0,v=void 0!==v?v:a.radius;var A=d,P=E,I=m,S=F,N=y,w=q,O=C,X=B,T=b,U=g,M=L,D=V,H=x,j=R,_=z;t.set(X,-l.length/2,0),t.set(T,l.length/2,0),t.rotate(U,X,h),t.rotate(M,T,h),n(U,U,u),n(M,M,u),t.copy(X,U),t.copy(T,M),o(w,T,X),t.normalize(O,w),t.rotate90cw(N,O),o(D,r,X);var W=i(D,N);o(S,X,u),o(H,r,u);var G=v+f;if(Math.abs(W)<G){t.scale(A,N,W),o(I,r,A),t.scale(P,N,i(N,H)),t.normalize(P,P),t.scale(P,P,f),n(I,I,P);var k=i(O,I),J=i(O,X),K=i(O,T);if(k>J&&k<K){if(p)return!0;var Q=this.createContactEquation(e,s,a,l);return t.scale(Q.normalA,A,-1),t.normalize(Q.normalA,Q.normalA),t.scale(Q.contactPointA,Q.normalA,v),n(Q.contactPointA,Q.contactPointA,r),o(Q.contactPointA,Q.contactPointA,e.position),o(Q.contactPointB,I,u),n(Q.contactPointB,Q.contactPointB,u),o(Q.contactPointB,Q.contactPointB,s.position),this.contactEquations.push(Q),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Q)),1}}_[0]=X,_[1]=T;for(var Y=0;Y<_.length;Y++){var Z=_[Y];if(o(D,Z,r),t.squaredLength(D)<Math.pow(G,2)){if(p)return!0;Q=this.createContactEquation(e,s,a,l);return t.copy(Q.normalA,D),t.normalize(Q.normalA,Q.normalA),t.scale(Q.contactPointA,Q.normalA,v),n(Q.contactPointA,Q.contactPointA,r),o(Q.contactPointA,Q.contactPointA,e.position),o(Q.contactPointB,Z,u),t.scale(j,Q.normalA,-f),n(Q.contactPointB,Q.contactPointB,j),n(Q.contactPointB,Q.contactPointB,u),o(Q.contactPointB,Q.contactPointB,s.position),this.contactEquations.push(Q),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Q)),1}}return 0},O.prototype[f.CIRCLE|f.CAPSULE]=O.prototype.circleCapsule=function(t,o,n,i,e,a,r,c,s){return this.circleLine(t,o,n,i,e,a,r,c,s,a.radius)},O.prototype[f.CIRCLE|f.CONVEX]=O.prototype[f.CIRCLE|f.BOX]=O.prototype.circleConvex=function(i,e,a,r,c,s,l,u,h,p){p="number"==typeof p?p:e.radius;for(var f=d,v=E,A=m,P=F,q=y,C=g,B=L,b=x,V=R,N=I,w=S,z=!1,O=Number.MAX_VALUE,X=s.vertices,T=0;T!==X.length+1;T++){var U=X[T%X.length],M=X[(T+1)%X.length];if(t.rotate(f,U,u),t.rotate(v,M,u),n(f,f,l),n(v,v,l),o(A,v,f),t.normalize(P,A),t.rotate90cw(q,P),t.scale(V,q,-e.radius),n(V,V,a),K(V,s,l,u)){t.sub(N,f,V);var D=Math.abs(t.dot(N,q));D<O&&(t.copy(w,V),O=D,t.scale(b,q,D),t.add(b,b,V),z=!0)}}if(z){if(h)return!0;var H=this.createContactEquation(i,c,e,s);return t.sub(H.normalA,w,a),t.normalize(H.normalA,H.normalA),t.scale(H.contactPointA,H.normalA,p),n(H.contactPointA,H.contactPointA,a),o(H.contactPointA,H.contactPointA,i.position),o(H.contactPointB,b,l),n(H.contactPointB,H.contactPointB,l),o(H.contactPointB,H.contactPointB,c.position),this.contactEquations.push(H),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(H)),1}if(p>0)for(T=0;T<X.length;T++){var j=X[T];if(t.rotate(B,j,u),n(B,B,l),o(C,B,a),t.squaredLength(C)<Math.pow(p,2)){if(h)return!0;H=this.createContactEquation(i,c,e,s);return t.copy(H.normalA,C),t.normalize(H.normalA,H.normalA),t.scale(H.contactPointA,H.normalA,p),n(H.contactPointA,H.contactPointA,a),o(H.contactPointA,H.contactPointA,i.position),o(H.contactPointB,B,l),n(H.contactPointB,H.contactPointB,l),o(H.contactPointB,H.contactPointB,c.position),this.contactEquations.push(H),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(H)),1}}return 0};var W=t.create(),G=t.create(),k=t.create(),J=t.create();function K(i,e,a,r){for(var c=W,s=G,l=k,u=J,h=i,p=e.vertices,f=null,v=0;v!==p.length+1;v++){var A=p[v%p.length],P=p[(v+1)%p.length];t.rotate(c,A,r),t.rotate(s,P,r),n(c,c,a),n(s,s,a),o(l,c,h),o(u,s,h);var d=t.crossLength(l,u);if(null===f&&(f=d),d*f<=0)return!1;f=d}return!0}O.prototype[f.PARTICLE|f.CONVEX]=O.prototype[f.PARTICLE|f.BOX]=O.prototype.particleConvex=function(e,a,r,c,s,l,u,h,p){var f=d,v=E,A=m,P=F,B=y,b=q,L=C,V=g,R=x,I=N,S=w,z=Number.MAX_VALUE,O=!1,X=l.vertices;if(!K(r,l,u,h))return 0;if(p)return!0;for(var T=0;T!==X.length+1;T++){var U=X[T%X.length],M=X[(T+1)%X.length];t.rotate(f,U,h),t.rotate(v,M,h),n(f,f,u),n(v,v,u),o(A,v,f),t.normalize(P,A),t.rotate90cw(B,P),o(V,r,f);i(V,B);o(b,f,u),o(L,r,u),t.sub(I,f,r);var D=Math.abs(t.dot(I,B));D<z&&(z=D,t.scale(R,B,D),t.add(R,R,r),t.copy(S,B),O=!0)}if(O){var H=this.createContactEquation(e,s,a,l);return t.scale(H.normalA,S,-1),t.normalize(H.normalA,H.normalA),t.set(H.contactPointA,0,0),n(H.contactPointA,H.contactPointA,r),o(H.contactPointA,H.contactPointA,e.position),o(H.contactPointB,R,u),n(H.contactPointB,H.contactPointB,u),o(H.contactPointB,H.contactPointB,s.position),this.contactEquations.push(H),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(H)),1}return 0},O.prototype[f.CIRCLE]=O.prototype.circleCircle=function(i,e,a,r,c,s,l,u,h,p,f){var v=d;p=p||e.radius,f=f||s.radius;o(v,a,l);var A=p+f;if(t.squaredLength(v)>Math.pow(A,2))return 0;if(h)return!0;var P=this.createContactEquation(i,c,e,s);return o(P.normalA,l,a),t.normalize(P.normalA,P.normalA),t.scale(P.contactPointA,P.normalA,p),t.scale(P.contactPointB,P.normalA,-f),n(P.contactPointA,P.contactPointA,a),o(P.contactPointA,P.contactPointA,i.position),n(P.contactPointB,P.contactPointB,l),o(P.contactPointB,P.contactPointB,c.position),this.contactEquations.push(P),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(P)),1},O.prototype[f.PLANE|f.CONVEX]=O.prototype[f.PLANE|f.BOX]=O.prototype.planeConvex=function(e,a,r,c,s,l,u,h,p){var f=d,v=E,A=m,F=0;t.rotate(v,P,c);for(var y=0;y!==l.vertices.length;y++){var q=l.vertices[y];if(t.rotate(f,q,h),n(f,f,u),o(A,f,r),i(A,v)<=0){if(p)return!0;F++;var C=this.createContactEquation(e,s,a,l);o(A,f,r),t.copy(C.normalA,v);var B=i(A,C.normalA);t.scale(A,C.normalA,B),o(C.contactPointB,f,s.position),o(C.contactPointA,f,A),o(C.contactPointA,C.contactPointA,e.position),this.contactEquations.push(C),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(C))}}return this.enableFrictionReduction&&this.enableFriction&&F&&this.frictionEquations.push(this.createFrictionFromAverage(F)),F},O.prototype[f.PARTICLE|f.PLANE]=O.prototype.particlePlane=function(n,e,a,r,c,s,l,u,h){var p=d,f=E;u=u||0,o(p,a,l),t.rotate(f,P,u);var v=i(p,f);if(v>0)return 0;if(h)return!0;var A=this.createContactEquation(c,n,s,e);return t.copy(A.normalA,f),t.scale(p,A.normalA,v),o(A.contactPointA,a,p),o(A.contactPointA,A.contactPointA,c.position),o(A.contactPointB,a,n.position),this.contactEquations.push(A),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(A)),1},O.prototype[f.CIRCLE|f.PARTICLE]=O.prototype.circleParticle=function(i,e,a,r,c,s,l,u,h){var p=d;if(o(p,l,a),t.squaredLength(p)>Math.pow(e.radius,2))return 0;if(h)return!0;var f=this.createContactEquation(i,c,e,s);return t.copy(f.normalA,p),t.normalize(f.normalA,f.normalA),t.scale(f.contactPointA,f.normalA,e.radius),n(f.contactPointA,f.contactPointA,a),o(f.contactPointA,f.contactPointA,i.position),o(f.contactPointB,l,c.position),this.contactEquations.push(f),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(f)),1};var Q=new h({radius:1}),Y=t.create(),Z=t.create(),$=t.create();O.prototype[f.PLANE|f.CAPSULE]=O.prototype.planeCapsule=function(o,i,e,a,r,c,s,l,u){var h,p=Y,f=Z,v=Q;t.set(p,-c.length/2,0),t.rotate(p,p,l),n(p,p,s),t.set(f,c.length/2,0),t.rotate(f,f,l),n(f,f,s),v.radius=c.radius,this.enableFrictionReduction&&(h=this.enableFriction,this.enableFriction=!1);var A=this.circlePlane(r,v,p,0,o,i,e,a,u),P=this.circlePlane(r,v,f,0,o,i,e,a,u);if(this.enableFrictionReduction&&(this.enableFriction=h),u)return A||P;var d=A+P;return this.enableFrictionReduction&&d&&this.frictionEquations.push(this.createFrictionFromAverage(d)),d},O.prototype[f.CIRCLE|f.PLANE]=O.prototype.circlePlane=function(e,a,r,c,s,l,u,h,p){var f=e,v=a,A=r,F=s,y=u,q=h;q=q||0;var C=d,B=E,b=m;o(C,A,y),t.rotate(B,P,q);var g=i(B,C);if(g>v.radius)return 0;if(p)return!0;var L=this.createContactEquation(F,f,l,a);return t.copy(L.normalA,B),t.scale(L.contactPointB,L.normalA,-v.radius),n(L.contactPointB,L.contactPointB,A),o(L.contactPointB,L.contactPointB,f.position),t.scale(b,L.normalA,g),o(L.contactPointA,C,b),n(L.contactPointA,L.contactPointA,y),o(L.contactPointA,L.contactPointA,F.position),this.contactEquations.push(L),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(L)),1},O.prototype[f.CONVEX]=O.prototype[f.CONVEX|f.BOX]=O.prototype[f.BOX]=O.prototype.convexConvex=function(e,a,r,c,s,l,u,h,p,f){var v=d,A=E,P=m,q=F,g=y,L=C,V=B,x=b,R=0;f="number"==typeof f?f:0;if(!O.findSeparatingAxis(a,r,c,l,u,h,v))return 0;o(V,u,r),i(v,V)>0&&t.scale(v,v,-1);var I=O.getClosestEdge(a,c,v,!0),S=O.getClosestEdge(l,h,v);if(-1===I||-1===S)return 0;for(var N=0;N<2;N++){var w,z=I,X=S,T=a,U=l,M=r,D=u,H=c,j=h,_=e,W=s;if(0===N)w=z,z=X,X=w,w=T,T=U,U=w,w=M,M=D,D=w,w=H,H=j,j=w,w=_,_=W,W=w;for(var G=X;G<X+2;G++){var k=U.vertices[(G+U.vertices.length)%U.vertices.length];t.rotate(A,k,j),n(A,A,D);for(var J=0,K=z-1;K<z+2;K++){var Q=T.vertices[(K+T.vertices.length)%T.vertices.length],Y=T.vertices[(K+1+T.vertices.length)%T.vertices.length];t.rotate(P,Q,H),t.rotate(q,Y,H),n(P,P,M),n(q,q,M),o(g,q,P),t.rotate90cw(x,g),t.normalize(x,x),o(V,A,P);var Z=i(x,V);(K===z&&Z<=f||K!==z&&Z<=0)&&J++}if(J>=3){if(p)return!0;var $=this.createContactEquation(_,W,T,U);R++;Q=T.vertices[z%T.vertices.length],Y=T.vertices[(z+1)%T.vertices.length];t.rotate(P,Q,H),t.rotate(q,Y,H),n(P,P,M),n(q,q,M),o(g,q,P),t.rotate90cw($.normalA,g),t.normalize($.normalA,$.normalA),o(V,A,P);Z=i($.normalA,V);t.scale(L,$.normalA,Z),o($.contactPointA,A,M),o($.contactPointA,$.contactPointA,L),n($.contactPointA,$.contactPointA,M),o($.contactPointA,$.contactPointA,_.position),o($.contactPointB,A,D),n($.contactPointB,$.contactPointB,D),o($.contactPointB,$.contactPointB,W.position),this.contactEquations.push($),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact($))}}}return this.enableFrictionReduction&&this.enableFriction&&R&&this.frictionEquations.push(this.createFrictionFromAverage(R)),R};var tt=t.fromValues(0,0);O.projectConvexOntoAxis=function(o,n,e,a,r){var c,s,l=null,u=null,h=tt;t.rotate(h,a,-e);for(var p=0;p<o.vertices.length;p++)c=o.vertices[p],s=i(c,h),(null===l||s>l)&&(l=s),(null===u||s<u)&&(u=s);if(u>l){var f=u;u=l,l=f}var v=i(n,a);t.set(r,u+v,l+v)};var ot=t.fromValues(0,0),nt=t.fromValues(0,0),it=t.fromValues(0,0),et=t.fromValues(0,0),at=t.fromValues(0,0),rt=t.fromValues(0,0);O.findSeparatingAxis=function(n,i,e,a,r,c,s){var l=null,u=!1,h=!1,p=ot,f=nt,v=it,P=et,d=at,E=rt;if(n instanceof A&&a instanceof A)for(var m=0;2!==m;m++){var F=n,y=e;1===m&&(F=a,y=c);for(var q=0;2!==q;q++){0===q?t.set(P,0,1):1===q&&t.set(P,1,0),0!==y&&t.rotate(P,P,y),O.projectConvexOntoAxis(n,i,e,P,d),O.projectConvexOntoAxis(a,r,c,P,E);var C=d,B=E;d[0]>E[0]&&(B=d,C=E,!0),u=(b=B[0]-C[1])<=0,(null===l||b>l)&&(t.copy(s,P),l=b,h=u)}}else for(m=0;2!==m;m++){F=n,y=e;1===m&&(F=a,y=c);for(q=0;q!==F.vertices.length;q++){t.rotate(f,F.vertices[q],y),t.rotate(v,F.vertices[(q+1)%F.vertices.length],y),o(p,v,f),t.rotate90cw(P,p),t.normalize(P,P),O.projectConvexOntoAxis(n,i,e,P,d),O.projectConvexOntoAxis(a,r,c,P,E);var b;C=d,B=E;d[0]>E[0]&&(B=d,C=E,!0),u=(b=B[0]-C[1])<=0,(null===l||b>l)&&(t.copy(s,P),l=b,h=u)}}return h};var ct=t.fromValues(0,0),st=t.fromValues(0,0),lt=t.fromValues(0,0);O.getClosestEdge=function(n,e,a,r){var c=ct,s=st,l=lt;t.rotate(c,a,-e),r&&t.scale(c,c,-1);for(var u=-1,h=n.vertices.length,p=-1,f=0;f!==h;f++){o(s,n.vertices[(f+1)%h],n.vertices[f%h]),t.rotate90cw(l,s),t.normalize(l,l);var v=i(l,c);(-1===u||v>p)&&(u=f%h,p=v)}return u};var ut=t.create(),ht=t.create(),pt=t.create(),ft=t.create(),vt=t.create(),At=t.create(),Pt=t.create();O.prototype[f.CIRCLE|f.HEIGHTFIELD]=O.prototype.circleHeightfield=function(i,e,a,r,c,s,l,u,h,p){var f=s.heights,v=(p=p||e.radius,s.elementWidth),A=ht,P=ut,d=vt,E=Pt,m=At,F=pt,y=ft,q=Math.floor((a[0]-p-l[0])/v),C=Math.ceil((a[0]+p-l[0])/v);q<0&&(q=0),C>=f.length&&(C=f.length-1);for(var B=f[q],b=f[C],g=q;g<C;g++)f[g]<b&&(b=f[g]),f[g]>B&&(B=f[g]);if(a[1]-p>B)return!h&&0;var L=!1;for(g=q;g<C;g++){t.set(F,g*v,f[g]),t.set(y,(g+1)*v,f[g+1]),t.add(F,F,l),t.add(y,y,l),t.sub(m,y,F),t.rotate(m,m,Math.PI/2),t.normalize(m,m),t.scale(P,m,-p),t.add(P,P,a),t.sub(A,P,F);var V=t.dot(A,m);if(P[0]>=F[0]&&P[0]<y[0]&&V<=0){if(h)return!0;L=!0,t.scale(A,m,-V),t.add(d,P,A),t.copy(E,m);var x=this.createContactEquation(c,i,s,e);t.copy(x.normalA,E),t.scale(x.contactPointB,x.normalA,-p),n(x.contactPointB,x.contactPointB,a),o(x.contactPointB,x.contactPointB,i.position),t.copy(x.contactPointA,d),t.sub(x.contactPointA,x.contactPointA,c.position),this.contactEquations.push(x),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}}if(L=!1,p>0)for(g=q;g<=C;g++)if(t.set(F,g*v,f[g]),t.add(F,F,l),t.sub(A,a,F),t.squaredLength(A)<Math.pow(p,2)){if(h)return!0;L=!0;x=this.createContactEquation(c,i,s,e);t.copy(x.normalA,A),t.normalize(x.normalA,x.normalA),t.scale(x.contactPointB,x.normalA,-p),n(x.contactPointB,x.contactPointB,a),o(x.contactPointB,x.contactPointB,i.position),o(x.contactPointA,F,l),n(x.contactPointA,x.contactPointA,l),o(x.contactPointA,x.contactPointA,c.position),this.contactEquations.push(x),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(x))}return L?1:0};var dt=t.create(),Et=t.create(),mt=t.create(),Ft=new p({vertices:[t.create(),t.create(),t.create(),t.create()]});O.prototype[f.BOX|f.HEIGHTFIELD]=O.prototype[f.CONVEX|f.HEIGHTFIELD]=O.prototype.convexHeightfield=function(o,n,i,e,a,r,c,s,l){var u=r.heights,h=r.elementWidth,p=dt,f=Et,v=mt,A=Ft,P=Math.floor((o.aabb.lowerBound[0]-c[0])/h),d=Math.ceil((o.aabb.upperBound[0]-c[0])/h);P<0&&(P=0),d>=u.length&&(d=u.length-1);for(var E=u[P],m=u[d],F=P;F<d;F++)u[F]<m&&(m=u[F]),u[F]>E&&(E=u[F]);if(o.aabb.lowerBound[1]>E)return!l&&0;var y=0;for(F=P;F<d;F++){t.set(p,F*h,u[F]),t.set(f,(F+1)*h,u[F+1]),t.add(p,p,c),t.add(f,f,c);t.set(v,.5*(f[0]+p[0]),.5*(f[1]+p[1]-100)),t.sub(A.vertices[0],f,v),t.sub(A.vertices[1],p,v),t.copy(A.vertices[2],A.vertices[1]),t.copy(A.vertices[3],A.vertices[0]),A.vertices[2][1]-=100,A.vertices[3][1]-=100,y+=this.convexConvex(o,n,i,e,a,A,v,0,l)}return y};
},{"../math/vec2":"jK4t","../utils/Utils":"vSqo","../utils/ContactEquationPool":"kuQI","../utils/FrictionEquationPool":"HAB3","../utils/TupleDictionary":"MDj9","../equations/Equation":"Bdcw","../equations/ContactEquation":"Xmyq","../equations/FrictionEquation":"KIQm","../shapes/Circle":"A4PI","../shapes/Convex":"Ji1u","../shapes/Shape":"Erhf","../objects/Body":"Ko1b","../shapes/Box":"k1Qp"}],"jfGk":[function(require,module,exports) {
var t=require("./Shape"),e=require("../math/vec2"),r=require("../utils/Utils");function o(e){(e=e||{}).type=t.PLANE,t.call(this,e)}module.exports=o,o.prototype=new t,o.prototype.constructor=o,o.prototype.computeMomentOfInertia=function(t){return 0},o.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},o.prototype.computeAABB=function(t,r,o){var a=o%(2*Math.PI),u=e.set,n=t.lowerBound,i=t.upperBound;u(n,-1e7,-1e7),u(i,1e7,1e7),0===a?i[1]=0:a===Math.PI/2?n[0]=0:a===Math.PI?n[1]=0:a===3*Math.PI/2&&(i[0]=0)},o.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var a=e.create(),u=e.create(),n=e.create(),i=e.create(),p=e.create();o.prototype.raycast=function(t,r,o,u){var n=r.from,c=r.to,s=r.direction,d=a,h=i,f=p;e.set(h,0,1),e.rotate(h,h,u),e.sub(f,n,o);var y=e.dot(f,h);if(e.sub(f,c,o),!(y*e.dot(f,h)>0||e.squaredDistance(n,c)<y*y)){var m=e.dot(h,s);e.sub(d,n,o);var v=-e.dot(h,d)/m/r.length;r.reportIntersection(t,v,h,-1)}};
},{"./Shape":"Erhf","../math/vec2":"jK4t","../utils/Utils":"vSqo"}],"HJzN":[function(require,module,exports) {
var o=require("./Shape"),t=require("../math/vec2");function e(t){(t=t||{}).type=o.PARTICLE,o.call(this,t)}module.exports=e,e.prototype=new o,e.prototype.constructor=e,e.prototype.computeMomentOfInertia=function(o){return 0},e.prototype.updateBoundingRadius=function(){this.boundingRadius=0},e.prototype.computeAABB=function(o,e,p){t.copy(o.lowerBound,e),t.copy(o.upperBound,e)};
},{"./Shape":"Erhf","../math/vec2":"jK4t"}],"BZzW":[function(require,module,exports) {
var e=require("../shapes/Circle"),r=require("../shapes/Plane"),a=require("../shapes/Shape"),o=require("../shapes/Particle"),t=require("../collision/Broadphase"),s=require("../math/vec2");function i(){t.call(this,t.NAIVE)}module.exports=i,i.prototype=new t,i.prototype.constructor=i,i.prototype.getCollisionPairs=function(e){var r=e.bodies,a=this.result;a.length=0;for(var o=0,s=r.length;o!==s;o++)for(var i=r[o],p=0;p<o;p++){var u=r[p];t.canCollide(i,u)&&this.boundingVolumeCheck(i,u)&&a.push(i,u)}return a},i.prototype.aabbQuery=function(e,r,a){a=a||[];for(var o=e.bodies,t=0;t<o.length;t++){var s=o[t];s.aabbNeedsUpdate&&s.updateAABB(),s.aabb.overlaps(r)&&a.push(s)}return a};
},{"../shapes/Circle":"A4PI","../shapes/Plane":"jfGk","../shapes/Shape":"Erhf","../shapes/Particle":"HJzN","../collision/Broadphase":"oqvr","../math/vec2":"jK4t"}],"sLOj":[function(require,module,exports) {
var t=require("./Equation"),e=require("../math/vec2");function r(e,r){t.call(this,e,r,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}module.exports=r,r.prototype=new t,r.prototype.constructor=r,r.prototype.computeB=function(t,e,r){var o=this.G;o[2]=-1,o[5]=this.ratio;var i=this.computeGiMf();return-this.computeGW()*e-r*i};
},{"./Equation":"Bdcw","../math/vec2":"jK4t"}],"RPhV":[function(require,module,exports) {
var e=require("./Equation"),t=require("../math/vec2");function r(t,r,o){o=o||{},e.call(this,t,r,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=o.angle||0;var a=this.G;a[2]=1,a[5]=-1}module.exports=r,r.prototype=new e,r.prototype.constructor=r;var o=t.create(),a=t.create(),n=t.fromValues(1,0),u=t.fromValues(0,1);r.prototype.computeGq=function(){return t.rotate(o,n,this.bodyA.angle+this.angle),t.rotate(a,u,this.bodyB.angle),t.dot(o,a)};
},{"./Equation":"Bdcw","../math/vec2":"jK4t"}],"XTju":[function(require,module,exports) {
var t=require("./Constraint"),i=require("../equations/Equation"),o=require("../equations/RotationalVelocityEquation"),e=require("../equations/RotationalLockEquation"),r=require("../math/vec2");module.exports=h;var n=r.create(),s=r.create(),a=r.fromValues(1,0),p=r.fromValues(0,1),u=r.create();function h(h,l,m){m=m||{},t.call(this,h,l,t.REVOLUTE,m);var c=this.maxForce=void 0!==m.maxForce?m.maxForce:Number.MAX_VALUE;this.pivotA=r.create(),this.pivotB=r.create(),m.worldPivot?(r.sub(this.pivotA,m.worldPivot,h.position),r.sub(this.pivotB,m.worldPivot,l.position),r.rotate(this.pivotA,this.pivotA,-h.angle),r.rotate(this.pivotB,this.pivotB,-l.angle)):(r.copy(this.pivotA,m.localPivotA),r.copy(this.pivotB,m.localPivotB));var d=this.equations=[new i(h,l,-c,c),new i(h,l,-c,c)],E=d[0],v=d[1],q=this;E.computeGq=function(){return r.rotate(n,q.pivotA,h.angle),r.rotate(s,q.pivotB,l.angle),r.add(u,l.position,s),r.sub(u,u,h.position),r.sub(u,u,n),r.dot(u,a)},v.computeGq=function(){return r.rotate(n,q.pivotA,h.angle),r.rotate(s,q.pivotB,l.angle),r.add(u,l.position,s),r.sub(u,u,h.position),r.sub(u,u,n),r.dot(u,p)},v.minForce=E.minForce=-c,v.maxForce=E.maxForce=c,this.motorEquation=new o(h,l),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new e(h,l),this.lowerLimitEquation=new e(h,l),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}h.prototype=new t,h.prototype.constructor=h,h.prototype.setLimits=function(t,i){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof i?(this.upperLimit=i,this.upperLimitEnabled=!0):(this.upperLimit=i,this.upperLimitEnabled=!1)},h.prototype.update=function(){var t,i=this.bodyA,o=this.bodyB,e=this.pivotA,u=this.pivotB,h=this.equations,l=(h[0],h[1],h[0]),m=h[1],c=this.upperLimit,d=this.lowerLimit,E=this.upperLimitEquation,v=this.lowerLimitEquation,q=this.angle=o.angle-i.angle;this.upperLimitEnabled&&q>c?(E.angle=c,-1===h.indexOf(E)&&h.push(E)):-1!==(t=h.indexOf(E))&&h.splice(t,1);this.lowerLimitEnabled&&q<d?(v.angle=d,-1===h.indexOf(v)&&h.push(v)):-1!==(t=h.indexOf(v))&&h.splice(t,1);r.rotate(n,e,i.angle),r.rotate(s,u,o.angle),l.G[0]=-1,l.G[1]=0,l.G[2]=-r.crossLength(n,a),l.G[3]=1,l.G[4]=0,l.G[5]=r.crossLength(s,a),m.G[0]=0,m.G[1]=-1,m.G[2]=-r.crossLength(n,p),m.G[3]=0,m.G[4]=1,m.G[5]=r.crossLength(s,p)},h.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},h.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},h.prototype.motorIsEnabled=function(){return!!this.motorEnabled},h.prototype.setMotorSpeed=function(t){if(this.motorEnabled){var i=this.equations.indexOf(this.motorEquation);this.equations[i].relativeVelocity=t}},h.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity};
},{"./Constraint":"Lh1u","../equations/Equation":"Bdcw","../equations/RotationalVelocityEquation":"sLOj","../equations/RotationalLockEquation":"RPhV","../math/vec2":"jK4t"}],"KYof":[function(require,module,exports) {
var t=require("./Constraint"),i=require("../equations/ContactEquation"),o=require("../equations/Equation"),e=require("../math/vec2"),n=require("../equations/RotationalLockEquation");function a(a,r,s){s=s||{},t.call(this,a,r,t.PRISMATIC,s);var c=e.fromValues(0,0),l=e.fromValues(1,0),u=e.fromValues(0,0);s.localAnchorA&&e.copy(c,s.localAnchorA),s.localAxisA&&e.copy(l,s.localAxisA),s.localAnchorB&&e.copy(u,s.localAnchorB),this.localAnchorA=c,this.localAnchorB=u,this.localAxisA=l;var h=this.maxForce=void 0!==s.maxForce?s.maxForce:Number.MAX_VALUE,p=new o(a,r,-h,h),m=new e.create,d=new e.create,L=new e.create,b=new e.create;if(p.computeGq=function(){return e.dot(L,b)},p.updateJacobian=function(){var t=this.G,i=a.position,o=r.position;e.rotate(m,c,a.angle),e.rotate(d,u,r.angle),e.add(L,o,d),e.sub(L,L,i),e.sub(L,L,m),e.rotate(b,l,a.angle+Math.PI/2),t[0]=-b[0],t[1]=-b[1],t[2]=-e.crossLength(m,b)+e.crossLength(b,L),t[3]=b[0],t[4]=b[1],t[5]=e.crossLength(d,b)},this.equations.push(p),!s.disableRotationalLock){var q=new n(a,r,-h,h);this.equations.push(q)}this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==s.lowerLimit,this.upperLimitEnabled=void 0!==s.upperLimit,this.lowerLimit=void 0!==s.lowerLimit?s.lowerLimit:0,this.upperLimit=void 0!==s.upperLimit?s.upperLimit:1,this.upperLimitEquation=new i(a,r),this.lowerLimitEquation=new i(a,r),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=h,this.motorEquation=new o(a,r),this.motorEnabled=!1,this.motorSpeed=0;var A=this,E=this.motorEquation;E.computeGW;E.computeGq=function(){return 0},E.computeGW=function(){var t=this.G,i=this.bodyA,o=this.bodyB,e=i.velocity,n=o.velocity,a=i.angularVelocity,r=o.angularVelocity;return this.gmult(t,e,a,n,r)+A.motorSpeed}}module.exports=a,a.prototype=new t,a.prototype.constructor=a;var r=e.create(),s=e.create(),c=e.create(),l=e.create(),u=e.create(),h=e.create();a.prototype.update=function(){var t=this.equations,i=t[0],o=this.upperLimit,n=this.lowerLimit,a=this.upperLimitEquation,p=this.lowerLimitEquation,m=this.bodyA,d=this.bodyB,L=this.localAxisA,b=this.localAnchorA,q=this.localAnchorB;i.updateJacobian(),e.rotate(r,L,m.angle),e.rotate(l,b,m.angle),e.add(s,l,m.position),e.rotate(u,q,d.angle),e.add(c,u,d.position);var A,E=this.position=e.dot(c,r)-e.dot(s,r);if(this.motorEnabled){var w=this.motorEquation.G;w[0]=r[0],w[1]=r[1],w[2]=e.crossLength(r,u),w[3]=-r[0],w[4]=-r[1],w[5]=-e.crossLength(r,l)}this.upperLimitEnabled&&E>o?(e.scale(a.normalA,r,-1),e.sub(a.contactPointA,s,m.position),e.sub(a.contactPointB,c,d.position),e.scale(h,r,o),e.add(a.contactPointA,a.contactPointA,h),-1===t.indexOf(a)&&t.push(a)):-1!==(A=t.indexOf(a))&&t.splice(A,1);this.lowerLimitEnabled&&E<n?(e.scale(p.normalA,r,1),e.sub(p.contactPointA,s,m.position),e.sub(p.contactPointB,c,d.position),e.scale(h,r,n),e.sub(p.contactPointB,p.contactPointB,h),-1===t.indexOf(p)&&t.push(p)):-1!==(A=t.indexOf(p))&&t.splice(A,1)},a.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},a.prototype.disableMotor=function(){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations.splice(t,1),this.motorEnabled=!1}},a.prototype.setLimits=function(t,i){"number"==typeof t?(this.lowerLimit=t,this.lowerLimitEnabled=!0):(this.lowerLimit=t,this.lowerLimitEnabled=!1),"number"==typeof i?(this.upperLimit=i,this.upperLimitEnabled=!0):(this.upperLimit=i,this.upperLimitEnabled=!1)};
},{"./Constraint":"Lh1u","../equations/ContactEquation":"Xmyq","../equations/Equation":"Bdcw","../math/vec2":"jK4t","../equations/RotationalLockEquation":"RPhV"}],"VQIW":[function(require,module,exports) {
var t=require("../utils/Utils"),o=require("../collision/Broadphase");function i(){o.call(this,o.SAP),this.axisList=[],this.axisIndex=0;var t=this;this._addBodyHandler=function(o){t.axisList.push(o.body)},this._removeBodyHandler=function(o){var i=t.axisList.indexOf(o.body);-1!==i&&t.axisList.splice(i,1)}}module.exports=i,i.prototype=new o,i.prototype.constructor=i,i.prototype.setWorld=function(o){this.axisList.length=0,t.appendArray(this.axisList,o.bodies),o.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),o.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=o},i.sortAxisList=function(t,o){o|=0;for(var i=1,s=t.length;i<s;i++){for(var r=t[i],e=i-1;e>=0&&!(t[e].aabb.lowerBound[o]<=r.aabb.lowerBound[o]);e--)t[e+1]=t[e];t[e+1]=r}return t},i.prototype.sortList=function(){var t=this.axisList,o=this.axisIndex;i.sortAxisList(t,o)},i.prototype.getCollisionPairs=function(t){var i=this.axisList,s=this.result,r=this.axisIndex;s.length=0;for(var e=i.length;e--;){var a=i[e];a.aabbNeedsUpdate&&a.updateAABB()}this.sortList();for(var d=0,n=0|i.length;d!==n;d++)for(var h=i[d],l=d+1;l<n;l++){var u=i[l];if(!(u.aabb.lowerBound[r]<=h.aabb.upperBound[r]))break;o.canCollide(h,u)&&this.boundingVolumeCheck(h,u)&&s.push(h,u)}return s},i.prototype.aabbQuery=function(t,o,i){i=i||[],this.sortList();var s=this.axisIndex,r="x";1===s&&(r="y"),2===s&&(r="z");for(var e=this.axisList,a=(o.lowerBound[r],o.upperBound[r],0);a<e.length;a++){var d=e[a];d.aabbNeedsUpdate&&d.updateAABB(),d.aabb.overlaps(o)&&i.push(d)}return i};
},{"../utils/Utils":"vSqo","../collision/Broadphase":"oqvr"}],"QbjC":[function(require,module,exports) {
var s=require("../math/vec2"),i=require("../utils/Utils");function t(s,t,e){e=i.defaults(e,{stiffness:100,damping:1}),this.stiffness=e.stiffness,this.damping=e.damping,this.bodyA=s,this.bodyB=t}module.exports=t,t.prototype.applyForce=function(){};
},{"../math/vec2":"jK4t","../utils/Utils":"vSqo"}],"mGMr":[function(require,module,exports) {
var t=require("../math/vec2"),o=require("../utils/Utils"),i=require("../constraints/Constraint"),e=require("../equations/FrictionEquation"),s=require("../objects/Body");function r(t,o){o=o||{},this.chassisBody=t,this.wheels=[],this.groundBody=new s({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function a(o,s){s=s||{},this.vehicle=o,this.forwardEquation=new e(o.chassisBody,o.groundBody),this.sideEquation=new e(o.chassisBody,o.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==s.sideFriction?s.sideFriction:5),this.localForwardVector=t.fromValues(0,1),s.localForwardVector&&t.copy(this.localForwardVector,s.localForwardVector),this.localPosition=t.fromValues(0,0),s.localPosition&&t.copy(this.localPosition,s.localPosition),i.apply(this,o.chassisBody,o.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}module.exports=r,r.prototype.addToWorld=function(t){this.world=t,t.addBody(this.groundBody),t.on("preStep",this.preStepCallback);for(var o=0;o<this.wheels.length;o++){var i=this.wheels[o];t.addConstraint(i)}},r.prototype.removeFromWorld=function(){var t=this.world;t.removeBody(this.groundBody),t.off("preStep",this.preStepCallback);for(var o=0;o<this.wheels.length;o++){var i=this.wheels[o];t.removeConstraint(i)}this.world=null},r.prototype.addWheel=function(t){var o=new a(this,t);return this.wheels.push(o),o},r.prototype.update=function(){for(var t=0;t<this.wheels.length;t++)this.wheels[t].update()},a.prototype=new i,a.prototype.setBrakeForce=function(t){this.forwardEquation.setSlipForce(t)},a.prototype.setSideFriction=function(t){this.sideEquation.setSlipForce(t)};var n=t.create(),h=t.create();a.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(h,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(n,h),t.dot(n,h)};var c=t.create();a.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),t.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),t.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),t.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),t.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),t.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),t.normalize(c,this.forwardEquation.t),t.scale(c,c,this.engineForce),this.vehicle.chassisBody.applyForce(c,this.forwardEquation.contactPointA)};
},{"../math/vec2":"jK4t","../utils/Utils":"vSqo","../constraints/Constraint":"Lh1u","../equations/FrictionEquation":"KIQm","../objects/Body":"Ko1b"}],"g8RS":[function(require,module,exports) {
var o=require("../math/vec2"),r=require("./Spring"),t=require("../utils/Utils");function e(t,e,c){c=c||{},r.call(this,t,e,c),this.localAnchorA=o.fromValues(0,0),this.localAnchorB=o.fromValues(0,0),c.localAnchorA&&o.copy(this.localAnchorA,c.localAnchorA),c.localAnchorB&&o.copy(this.localAnchorB,c.localAnchorB),c.worldAnchorA&&this.setWorldAnchorA(c.worldAnchorA),c.worldAnchorB&&this.setWorldAnchorB(c.worldAnchorB);var l=o.create(),s=o.create();this.getWorldAnchorA(l),this.getWorldAnchorB(s);var n=o.distance(l,s);this.restLength="number"==typeof c.restLength?c.restLength:n}module.exports=e,e.prototype=new r,e.prototype.constructor=e,e.prototype.setWorldAnchorA=function(o){this.bodyA.toLocalFrame(this.localAnchorA,o)},e.prototype.setWorldAnchorB=function(o){this.bodyB.toLocalFrame(this.localAnchorB,o)},e.prototype.getWorldAnchorA=function(o){this.bodyA.toWorldFrame(o,this.localAnchorA)},e.prototype.getWorldAnchorB=function(o){this.bodyB.toWorldFrame(o,this.localAnchorB)};var c=o.create(),l=o.create(),s=o.create(),n=o.create(),h=o.create(),a=o.create(),i=o.create(),A=o.create(),d=o.create();e.prototype.applyForce=function(){var r=this.stiffness,t=this.damping,e=this.restLength,u=this.bodyA,p=this.bodyB,y=c,g=l,B=s,f=n,b=d,W=h,m=a,v=i,L=A;this.getWorldAnchorA(W),this.getWorldAnchorB(m),o.sub(v,W,u.position),o.sub(L,m,p.position),o.sub(y,m,W);var F=o.len(y);o.normalize(g,y),o.sub(B,p.velocity,u.velocity),o.crossZV(b,p.angularVelocity,L),o.add(B,B,b),o.crossZV(b,u.angularVelocity,v),o.sub(B,B,b),o.scale(f,g,-r*(F-e)-t*o.dot(B,g)),o.sub(u.force,u.force,f),o.add(p.force,p.force,f);var V=o.crossLength(v,f),w=o.crossLength(L,f);u.angularForce-=V,p.angularForce+=w};
},{"../math/vec2":"jK4t","./Spring":"QbjC","../utils/Utils":"vSqo"}],"XhY7":[function(require,module,exports) {
var e=require("../math/vec2"),t=require("./Spring");function r(e,r,n){n=n||{},t.call(this,e,r,n),this.restAngle="number"==typeof n.restAngle?n.restAngle:r.angle-e.angle}module.exports=r,r.prototype=new t,r.prototype.constructor=r,r.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,r=this.restAngle,n=this.bodyA,o=this.bodyB,a=-e*(o.angle-n.angle-r)-t*(o.angularVelocity-n.angularVelocity)*0;n.angularForce-=a,o.angularForce+=a};
},{"../math/vec2":"jK4t","./Spring":"QbjC"}],"Udrc":[function(require,module,exports) {
module.exports={name:"p2",version:"0.7.1",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.1"},_resolved:"https://registry.npmjs.org/p2/-/p2-0.7.1.tgz",_integrity:"sha1-JfJHTZvDptMUCh2iamfJ4RislUM=",_from:"p2@0.7.1"};
},{}],"zpW4":[function(require,module,exports) {
function t(t,s,o,h){this.shapeA=s,this.shapeB=h,this.bodyA=t,this.bodyB=o}module.exports=t,t.prototype.set=function(s,o,h,i){t.call(this,s,o,h,i)};
},{}],"rBtr":[function(require,module,exports) {
var e=require("./OverlapKeeperRecord"),o=require("./Pool");function r(){o.apply(this,arguments)}module.exports=r,r.prototype=new o,r.prototype.constructor=r,r.prototype.create=function(){return new e},r.prototype.destroy=function(e){return e.bodyA=e.bodyB=e.shapeA=e.shapeB=null,this};
},{"./OverlapKeeperRecord":"zpW4","./Pool":"ajVA"}],"vkVH":[function(require,module,exports) {
var e=require("./TupleDictionary"),t=require("./OverlapKeeperRecord"),r=require("./OverlapKeeperRecordPool"),a=require("./Utils");function p(){this.overlappingShapesLastState=new e,this.overlappingShapesCurrentState=new e,this.recordPool=new r({size:16}),this.tmpDict=new e,this.tmpArray1=[]}module.exports=p,p.prototype.tick=function(){for(var e=this.overlappingShapesLastState,t=this.overlappingShapesCurrentState,r=e.keys.length;r--;){var a=e.keys[r],p=e.getByKey(a);t.getByKey(a);p&&this.recordPool.release(p)}e.reset(),e.copy(t),t.reset()},p.prototype.setOverlapping=function(e,t,r,a){this.overlappingShapesLastState;var p=this.overlappingShapesCurrentState;if(!p.get(t.id,a.id)){var i=this.recordPool.get();i.set(e,t,r,a),p.set(t.id,a.id,i)}},p.prototype.getNewOverlaps=function(e){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,e)},p.prototype.getEndOverlaps=function(e){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,e)},p.prototype.bodiesAreOverlapping=function(e,t){for(var r=this.overlappingShapesCurrentState,a=r.keys.length;a--;){var p=r.keys[a],i=r.data[p];if(i.bodyA===e&&i.bodyB===t||i.bodyA===t&&i.bodyB===e)return!0}return!1},p.prototype.getDiff=function(e,t,r){var a=e,p=t;(r=r||[]).length=0;for(var i=p.keys.length;i--;){var o=p.keys[i],s=p.data[o];if(!s)throw new Error("Key "+o+" had no data!");a.data[o]||r.push(s)}return r},p.prototype.isNewOverlap=function(e,t){var r=0|e.id,a=0|t.id,p=this.overlappingShapesLastState,i=this.overlappingShapesCurrentState;return!p.get(r,a)&&!!i.get(r,a)},p.prototype.getNewBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)},p.prototype.getEndBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)},p.prototype.getBodyDiff=function(e,t){t=t||[];for(var r=this.tmpDict,a=e.length;a--;){var p=e[a];r.set(0|p.bodyA.id,0|p.bodyB.id,p)}for(a=r.keys.length;a--;){(p=r.getByKey(r.keys[a]))&&t.push(p.bodyA,p.bodyB)}return r.reset(),t};
},{"./TupleDictionary":"MDj9","./OverlapKeeperRecord":"zpW4","./OverlapKeeperRecordPool":"rBtr","./Utils":"vSqo"}],"IQQD":[function(require,module,exports) {
var e=require("../objects/Body");function t(){this.equations=[],this.bodies=[]}module.exports=t,t.prototype.reset=function(){this.equations.length=this.bodies.length=0};var o=[];t.prototype.getBodies=function(e){var t=e||[],i=this.equations;o.length=0;for(var s=0;s!==i.length;s++){var n=i[s];-1===o.indexOf(n.bodyA.id)&&(t.push(n.bodyA),o.push(n.bodyA.id)),-1===o.indexOf(n.bodyB.id)&&(t.push(n.bodyB),o.push(n.bodyB.id))}return t},t.prototype.wantsToSleep=function(){for(var t=0;t<this.bodies.length;t++){var o=this.bodies[t];if(o.type===e.DYNAMIC&&!o.wantsToSleep)return!1}return!0},t.prototype.sleep=function(){for(var e=0;e<this.bodies.length;e++){this.bodies[e].sleep()}return!0};
},{"../objects/Body":"Ko1b"}],"QFIo":[function(require,module,exports) {
function t(t){this.body=t,this.neighbors=[],this.equations=[],this.visited=!1}module.exports=t,t.prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null};
},{}],"RJh9":[function(require,module,exports) {
var t=require("../world/IslandNode"),e=require("./Pool");function o(){e.apply(this,arguments)}module.exports=o,o.prototype=new e,o.prototype.constructor=o,o.prototype.create=function(){return new t},o.prototype.destroy=function(t){return t.reset(),this};
},{"../world/IslandNode":"QFIo","./Pool":"ajVA"}],"aU6S":[function(require,module,exports) {
var t=require("../world/Island"),r=require("./Pool");function e(){r.apply(this,arguments)}module.exports=e,e.prototype=new r,e.prototype.constructor=e,e.prototype.create=function(){return new t},e.prototype.destroy=function(t){return t.reset(),this};
},{"../world/Island":"IQQD","./Pool":"ajVA"}],"TX3m":[function(require,module,exports) {
var e=require("../math/vec2"),i=require("./Island"),s=require("./IslandNode"),o=require("./../utils/IslandNodePool"),t=require("./../utils/IslandPool"),n=require("../objects/Body");function r(e){this.nodePool=new o({size:16}),this.islandPool=new t({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}module.exports=r,r.getUnvisitedNode=function(e){for(var i=e.length,s=0;s!==i;s++){var o=e[s];if(!o.visited&&o.body.type===n.DYNAMIC)return o}return!1},r.prototype.visit=function(e,i,s){i.push(e.body);for(var o=e.equations.length,t=0;t!==o;t++){var n=e.equations[t];-1===s.indexOf(n)&&s.push(n)}},r.prototype.bfs=function(e,i,s){var o=this.queue;for(o.length=0,o.push(e),e.visited=!0,this.visit(e,i,s);o.length;)for(var t,h=o.pop();t=r.getUnvisitedNode(h.neighbors);)t.visited=!0,this.visit(t,i,s),t.body.type===n.DYNAMIC&&o.push(t)},r.prototype.split=function(e){for(var i=e.bodies,s=this.nodes,o=this.equations;s.length;)this.nodePool.release(s.pop());for(var t=0;t!==i.length;t++){var n=this.nodePool.get();n.body=i[t],s.push(n)}for(var h=0;h!==o.length;h++){var d=o[h],u=(t=i.indexOf(d.bodyA),i.indexOf(d.bodyB)),a=s[t],l=s[u];a.neighbors.push(l),l.neighbors.push(a),a.equations.push(d),l.equations.push(d)}var p,v=this.islands;for(t=0;t<v.length;t++)this.islandPool.release(v[t]);for(v.length=0;p=r.getUnvisitedNode(s);){var f=this.islandPool.get();this.bfs(p,f.bodies,f.equations),v.push(f)}return v};
},{"../math/vec2":"jK4t","./Island":"IQQD","./IslandNode":"QFIo","./../utils/IslandNodePool":"RJh9","./../utils/IslandPool":"aU6S","../objects/Body":"Ko1b"}],"yQ34":[function(require,module,exports) {
var t=require("../solver/GSSolver"),e=require("../solver/Solver"),i=require("../collision/Ray"),s=require("../math/vec2"),a=require("../shapes/Circle"),o=require("../shapes/Convex"),r=require("../shapes/Line"),n=require("../shapes/Plane"),l=require("../shapes/Capsule"),p=require("../shapes/Particle"),h=require("../events/EventEmitter"),c=require("../objects/Body"),u=require("../shapes/Shape"),d=require("../objects/LinearSpring"),f=require("../material/Material"),v=require("../material/ContactMaterial"),y=require("../constraints/DistanceConstraint"),g=require("../constraints/Constraint"),m=require("../constraints/LockConstraint"),E=require("../constraints/RevoluteConstraint"),q=require("../constraints/PrismaticConstraint"),S=require("../constraints/GearConstraint"),b=require("../../package.json"),B=require("../collision/Broadphase"),C=require("../collision/AABB"),A=require("../collision/SAPBroadphase"),M=require("../collision/Narrowphase"),w=require("../utils/Utils"),I=require("../utils/OverlapKeeper"),G=require("./IslandManager"),N=require("../objects/RotationalSpring");function P(e){h.apply(this),e=e||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=e.solver||new t,this.narrowphase=new M(this),this.islandManager=new G,this.gravity=s.fromValues(0,-9.78),e.gravity&&s.copy(this.gravity,e.gravity),this.frictionGravity=s.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=e.broadphase||new A,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new f,this.defaultContactMaterial=new v(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===e.islandSplit||!!e.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=P.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new I}module.exports=P,P.prototype=new Object(h.prototype),P.prototype.constructor=P,P.NO_SLEEPING=1,P.BODY_SLEEPING=2,P.ISLAND_SLEEPING=4,P.prototype.addConstraint=function(t){this.constraints.push(t)},P.prototype.addContactMaterial=function(t){this.contactMaterials.push(t)},P.prototype.removeContactMaterial=function(t){var e=this.contactMaterials.indexOf(t);-1!==e&&w.splice(this.contactMaterials,e,1)},P.prototype.getContactMaterial=function(t,e){for(var i=this.contactMaterials,s=0,a=i.length;s!==a;s++){var o=i[s];if(o.materialA.id===t.id&&o.materialB.id===e.id||o.materialA.id===e.id&&o.materialB.id===t.id)return o}return!1},P.prototype.removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e&&w.splice(this.constraints,e,1)};var L=s.create(),T=s.create(),x=s.create(),k=s.create(),O=s.create(),R=s.create(),D=s.create(),F=s.fromValues(0,0),V=s.fromValues(0,0),_=s.fromValues(0,0),K=s.fromValues(0,0);P.prototype.step=function(t,e,i){if(i=i||10,0===(e=e||0))this.internalStep(t),this.time+=t;else{this.accumulator+=e;for(var a=0;this.accumulator>=t&&a<i;)this.internalStep(t),this.time+=t,this.accumulator-=t,a++;for(var o=this.accumulator%t/t,r=0;r!==this.bodies.length;r++){var n=this.bodies[r];s.lerp(n.interpolatedPosition,n.previousPosition,n.position,o),n.interpolatedAngle=n.previousAngle+o*(n.angle-n.previousAngle)}}};var U=[];P.prototype.internalStep=function(t){this.stepping=!0;var e=this.springs.length,i=this.springs,a=this.bodies,o=this.gravity,r=this.solver,n=this.bodies.length,l=this.broadphase,p=this.narrowphase,h=this.constraints,u=D,d=(s.scale,s.add),f=(s.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=t,this.useWorldGravityAsFrictionGravity){var v=s.length(this.gravity);0===v&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=v)}if(this.applyGravity)for(var y=0;y!==n;y++){var g=(m=a[y]).force;m.type===c.DYNAMIC&&m.sleepState!==c.SLEEPING&&(s.scale(u,o,m.mass*m.gravityScale),d(g,g,u))}if(this.applySpringForces)for(y=0;y!==e;y++){i[y].applyForce()}if(this.applyDamping)for(y=0;y!==n;y++){var m;(m=a[y]).type===c.DYNAMIC&&m.applyDamping(t)}var E=l.getCollisionPairs(this),q=this.disabledBodyCollisionPairs;for(y=q.length-2;y>=0;y-=2)for(var S=E.length-2;S>=0;S-=2)(q[y]===E[S]&&q[y+1]===E[S+1]||q[y+1]===E[S]&&q[y]===E[S+1])&&E.splice(S,2);var b=h.length;for(y=0;y!==b;y++){var B=h[y];if(!B.collideConnected)for(S=E.length-2;S>=0;S-=2)(B.bodyA===E[S]&&B.bodyB===E[S+1]||B.bodyB===E[S]&&B.bodyA===E[S+1])&&E.splice(S,2)}this.postBroadphaseEvent.pairs=E,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,p.reset(this);y=0;for(var C=E.length;y!==C;y+=2)for(var A=E[y],M=E[y+1],I=0,G=A.shapes.length;I!==G;I++)for(var N=A.shapes[I],L=N.position,T=N.angle,x=0,k=M.shapes.length;x!==k;x++){var O=M.shapes[x],R=O.position,F=O.angle,V=this.defaultContactMaterial;if(N.material&&O.material){var _=this.getContactMaterial(N.material,O.material);_&&(V=_)}this.runNarrowphase(p,A,N,L,T,M,O,R,F,V,this.frictionGravity)}for(y=0;y!==n;y++){(W=a[y])._wakeUpAfterNarrowphase&&(W.wakeUp(),W._wakeUpAfterNarrowphase=!1)}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(U);var K=this.endContactEvent;for(x=U.length;x--;){var Y=U[x];K.shapeA=Y.shapeA,K.shapeB=Y.shapeB,K.bodyA=Y.bodyA,K.bodyB=Y.bodyB,this.emit(K)}U.length=0}var j=this.preSolveEvent;j.contactEquations=p.contactEquations,j.frictionEquations=p.frictionEquations,this.emit(j),j.contactEquations=j.frictionEquations=null;b=h.length;for(y=0;y!==b;y++)h[y].update();if(p.contactEquations.length||p.frictionEquations.length||b)if(this.islandSplit){for(f.equations.length=0,w.appendArray(f.equations,p.contactEquations),w.appendArray(f.equations,p.frictionEquations),y=0;y!==b;y++)w.appendArray(f.equations,h[y].equations);f.split(this);for(y=0;y!==f.islands.length;y++){(H=f.islands[y]).equations.length&&r.solveIsland(t,H)}}else{for(r.addEquations(p.contactEquations),r.addEquations(p.frictionEquations),y=0;y!==b;y++)r.addEquations(h[y].equations);this.solveConstraints&&r.solve(t,this),r.removeAllEquations()}for(y=0;y!==n;y++){var W;(W=a[y]).integrate(t)}for(y=0;y!==n;y++)a[y].setZeroForce();if(this.emitImpactEvent&&this.has("impact")){var Z=this.impactEvent;for(y=0;y!==p.contactEquations.length;y++){var z=p.contactEquations[y];z.firstImpact&&(Z.bodyA=z.bodyA,Z.bodyB=z.bodyB,Z.shapeA=z.shapeA,Z.shapeB=z.shapeB,Z.contactEquation=z,this.emit(Z))}}if(this.sleepMode===P.BODY_SLEEPING)for(y=0;y!==n;y++)a[y].sleepTick(this.time,!1,t);else if(this.sleepMode===P.ISLAND_SLEEPING&&this.islandSplit){for(y=0;y!==n;y++)a[y].sleepTick(this.time,!0,t);for(y=0;y<this.islandManager.islands.length;y++){var H;(H=this.islandManager.islands[y]).wantsToSleep()&&H.sleep()}}this.stepping=!1;var Q=this.bodiesToBeRemoved;for(y=0;y!==Q.length;y++)this.removeBody(Q[y]);Q.length=0,this.emit(this.postStepEvent)},P.prototype.runNarrowphase=function(t,e,i,a,o,r,n,l,p,h,u){if(0!=(i.collisionGroup&n.collisionMask)&&0!=(n.collisionGroup&i.collisionMask)){s.rotate(F,a,e.angle),s.rotate(V,l,r.angle),s.add(F,F,e.position),s.add(V,V,r.position);var d,f=o+e.angle,v=p+r.angle;t.enableFriction=h.friction>0,t.frictionCoefficient=h.friction,d=e.type===c.STATIC||e.type===c.KINEMATIC?r.mass:r.type===c.STATIC||r.type===c.KINEMATIC?e.mass:e.mass*r.mass/(e.mass+r.mass),t.slipForce=h.friction*u*d,t.restitution=h.restitution,t.surfaceVelocity=h.surfaceVelocity,t.frictionStiffness=h.frictionStiffness,t.frictionRelaxation=h.frictionRelaxation,t.stiffness=h.stiffness,t.relaxation=h.relaxation,t.contactSkinSize=h.contactSkinSize,t.enabledEquations=e.collisionResponse&&r.collisionResponse&&i.collisionResponse&&n.collisionResponse;var y=t[i.type|n.type],g=0;if(y){var m=i.sensor||n.sensor,E=t.frictionEquations.length;g=i.type<n.type?y.call(t,e,i,F,f,r,n,V,v,m):y.call(t,r,n,V,v,e,i,F,f,m);var q=t.frictionEquations.length-E;if(g){if(e.allowSleep&&e.type===c.DYNAMIC&&e.sleepState===c.SLEEPING&&r.sleepState===c.AWAKE&&r.type!==c.STATIC)s.squaredLength(r.velocity)+Math.pow(r.angularVelocity,2)>=2*Math.pow(r.sleepSpeedLimit,2)&&(e._wakeUpAfterNarrowphase=!0);if(r.allowSleep&&r.type===c.DYNAMIC&&r.sleepState===c.SLEEPING&&e.sleepState===c.AWAKE&&e.type!==c.STATIC)s.squaredLength(e.velocity)+Math.pow(e.angularVelocity,2)>=2*Math.pow(e.sleepSpeedLimit,2)&&(r._wakeUpAfterNarrowphase=!0);if(this.overlapKeeper.setOverlapping(e,i,r,n),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,n)){var S=this.beginContactEvent;if(S.shapeA=i,S.shapeB=n,S.bodyA=e,S.bodyB=r,S.contactEquations.length=0,"number"==typeof g)for(var b=t.contactEquations.length-g;b<t.contactEquations.length;b++)S.contactEquations.push(t.contactEquations[b]);this.emit(S)}if("number"==typeof g&&q>1)for(b=t.frictionEquations.length-q;b<t.frictionEquations.length;b++){var B=t.frictionEquations[b];B.setSlipForce(B.getSlipForce()/q)}}}}},P.prototype.addSpring=function(t){this.springs.push(t);var e=this.addSpringEvent;e.spring=t,this.emit(e),e.spring=null},P.prototype.removeSpring=function(t){var e=this.springs.indexOf(t);-1!==e&&w.splice(this.springs,e,1)},P.prototype.addBody=function(t){if(-1===this.bodies.indexOf(t)){this.bodies.push(t),t.world=this;var e=this.addBodyEvent;e.body=t,this.emit(e),e.body=null}},P.prototype.removeBody=function(t){if(this.stepping)this.bodiesToBeRemoved.push(t);else{t.world=null;var e=this.bodies.indexOf(t);-1!==e&&(w.splice(this.bodies,e,1),this.removeBodyEvent.body=t,t.resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},P.prototype.getBodyById=function(t){for(var e=this.bodies,i=0;i<e.length;i++){var s=e[i];if(s.id===t)return s}return!1},P.prototype.disableBodyCollision=function(t,e){this.disabledBodyCollisionPairs.push(t,e)},P.prototype.enableBodyCollision=function(t,e){for(var i=this.disabledBodyCollisionPairs,s=0;s<i.length;s+=2)if(i[s]===t&&i[s+1]===e||i[s+1]===t&&i[s]===e)return void i.splice(s,2)},P.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var t=this.constraints,e=t.length-1;e>=0;e--)this.removeConstraint(t[e]);var i=this.bodies;for(e=i.length-1;e>=0;e--)this.removeBody(i[e]);var s=this.springs;for(e=s.length-1;e>=0;e--)this.removeSpring(s[e]);var a=this.contactMaterials;for(e=a.length-1;e>=0;e--)this.removeContactMaterial(a[e]);P.apply(this)};var Y=s.create(),j=s.fromValues(0,0),W=s.fromValues(0,0);P.prototype.hitTest=function(t,e,i){i=i||0;var r=new c({position:t}),h=new p,u=t,d=Y,f=W;r.addShape(h);for(var v=this.narrowphase,y=[],g=0,m=e.length;g!==m;g++)for(var E=e[g],q=0,S=E.shapes.length;q!==S;q++){var b=E.shapes[q];s.rotate(d,b.position,E.angle),s.add(d,d,E.position);var B=b.angle+E.angle;(b instanceof a&&v.circleParticle(E,b,d,B,r,h,u,0,!0)||b instanceof o&&v.particleConvex(r,h,u,0,E,b,d,B,!0)||b instanceof n&&v.particlePlane(r,h,u,0,E,b,d,B,!0)||b instanceof l&&v.particleCapsule(r,h,u,0,E,b,d,B,!0)||b instanceof p&&s.squaredLength(s.sub(f,d,t))<i*i)&&y.push(E)}return y},P.prototype.setGlobalStiffness=function(t){for(var e=this.constraints,i=0;i!==e.length;i++)for(var s=e[i],a=0;a!==s.equations.length;a++){var o=s.equations[a];o.stiffness=t,o.needsUpdate=!0}var r=this.contactMaterials;for(i=0;i!==r.length;i++){(s=r[i]).stiffness=s.frictionStiffness=t}(s=this.defaultContactMaterial).stiffness=s.frictionStiffness=t},P.prototype.setGlobalRelaxation=function(t){for(var e=0;e!==this.constraints.length;e++)for(var i=this.constraints[e],s=0;s!==i.equations.length;s++){var a=i.equations[s];a.relaxation=t,a.needsUpdate=!0}for(e=0;e!==this.contactMaterials.length;e++){(i=this.contactMaterials[e]).relaxation=i.frictionRelaxation=t}(i=this.defaultContactMaterial).relaxation=i.frictionRelaxation=t};var Z=new C,z=[];P.prototype.raycast=function(t,e){return e.getAABB(Z),this.broadphase.aabbQuery(this,Z,z),e.intersectBodies(t,z),z.length=0,t.hasHit()};
},{"../solver/GSSolver":"AkER","../solver/Solver":"meaD","../collision/Ray":"fPko","../math/vec2":"jK4t","../shapes/Circle":"A4PI","../shapes/Convex":"Ji1u","../shapes/Line":"TmGq","../shapes/Plane":"jfGk","../shapes/Capsule":"QsEX","../shapes/Particle":"HJzN","../events/EventEmitter":"V1ry","../objects/Body":"Ko1b","../shapes/Shape":"Erhf","../objects/LinearSpring":"g8RS","../material/Material":"imEs","../material/ContactMaterial":"oPge","../constraints/DistanceConstraint":"ceTU","../constraints/Constraint":"Lh1u","../constraints/LockConstraint":"Z6xo","../constraints/RevoluteConstraint":"XTju","../constraints/PrismaticConstraint":"KYof","../constraints/GearConstraint":"krUx","../../package.json":"Udrc","../collision/Broadphase":"oqvr","../collision/AABB":"YFQU","../collision/SAPBroadphase":"VQIW","../collision/Narrowphase":"RcXI","../utils/Utils":"vSqo","../utils/OverlapKeeper":"vkVH","./IslandManager":"TX3m","../objects/RotationalSpring":"XhY7"}],"ZMtE":[function(require,module,exports) {
var e=module.exports={AABB:require("./collision/AABB"),AngleLockEquation:require("./equations/AngleLockEquation"),Body:require("./objects/Body"),Broadphase:require("./collision/Broadphase"),Capsule:require("./shapes/Capsule"),Circle:require("./shapes/Circle"),Constraint:require("./constraints/Constraint"),ContactEquation:require("./equations/ContactEquation"),ContactEquationPool:require("./utils/ContactEquationPool"),ContactMaterial:require("./material/ContactMaterial"),Convex:require("./shapes/Convex"),DistanceConstraint:require("./constraints/DistanceConstraint"),Equation:require("./equations/Equation"),EventEmitter:require("./events/EventEmitter"),FrictionEquation:require("./equations/FrictionEquation"),FrictionEquationPool:require("./utils/FrictionEquationPool"),GearConstraint:require("./constraints/GearConstraint"),GSSolver:require("./solver/GSSolver"),Heightfield:require("./shapes/Heightfield"),Line:require("./shapes/Line"),LockConstraint:require("./constraints/LockConstraint"),Material:require("./material/Material"),Narrowphase:require("./collision/Narrowphase"),NaiveBroadphase:require("./collision/NaiveBroadphase"),Particle:require("./shapes/Particle"),Plane:require("./shapes/Plane"),Pool:require("./utils/Pool"),RevoluteConstraint:require("./constraints/RevoluteConstraint"),PrismaticConstraint:require("./constraints/PrismaticConstraint"),Ray:require("./collision/Ray"),RaycastResult:require("./collision/RaycastResult"),Box:require("./shapes/Box"),RotationalVelocityEquation:require("./equations/RotationalVelocityEquation"),SAPBroadphase:require("./collision/SAPBroadphase"),Shape:require("./shapes/Shape"),Solver:require("./solver/Solver"),Spring:require("./objects/Spring"),TopDownVehicle:require("./objects/TopDownVehicle"),LinearSpring:require("./objects/LinearSpring"),RotationalSpring:require("./objects/RotationalSpring"),Utils:require("./utils/Utils"),World:require("./world/World"),vec2:require("./math/vec2"),version:require("../package.json").version};Object.defineProperty(e,"Rectangle",{get:function(){return console.warn("The Rectangle class has been renamed to Box."),this.Box}});
},{"./collision/AABB":"YFQU","./equations/AngleLockEquation":"BWCG","./objects/Body":"Ko1b","./collision/Broadphase":"oqvr","./shapes/Capsule":"QsEX","./shapes/Circle":"A4PI","./constraints/Constraint":"Lh1u","./equations/ContactEquation":"Xmyq","./utils/ContactEquationPool":"kuQI","./material/ContactMaterial":"oPge","./shapes/Convex":"Ji1u","./constraints/DistanceConstraint":"ceTU","./equations/Equation":"Bdcw","./events/EventEmitter":"V1ry","./equations/FrictionEquation":"KIQm","./utils/FrictionEquationPool":"HAB3","./constraints/GearConstraint":"krUx","./solver/GSSolver":"AkER","./shapes/Heightfield":"rs8L","./shapes/Line":"TmGq","./constraints/LockConstraint":"Z6xo","./material/Material":"imEs","./collision/Narrowphase":"RcXI","./collision/NaiveBroadphase":"BZzW","./shapes/Particle":"HJzN","./shapes/Plane":"jfGk","./utils/Pool":"ajVA","./constraints/RevoluteConstraint":"XTju","./constraints/PrismaticConstraint":"KYof","./collision/Ray":"fPko","./collision/RaycastResult":"rQoL","./shapes/Box":"k1Qp","./equations/RotationalVelocityEquation":"sLOj","./collision/SAPBroadphase":"VQIW","./shapes/Shape":"Erhf","./solver/Solver":"meaD","./objects/Spring":"QbjC","./objects/TopDownVehicle":"mGMr","./objects/LinearSpring":"g8RS","./objects/RotationalSpring":"XhY7","./utils/Utils":"vSqo","./world/World":"yQ34","./math/vec2":"jK4t","../package.json":"Udrc"}],"Gf3d":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.canvas={size:{width:1600,height:1e3}},exports.ball={radius:20,mass:1,damping:.1},exports.goal={size:{height:200,width:50},postRadius:15,cornerRadius:30,cornerPointsAmount:5};var e={height:1e3,width:1600},t=2*exports.goal.size.width;exports.map={size:{height:e.height,width:e.width},outerSize:{height:e.height+2*t,width:e.width+2*t},cornerPointsAmount:16,cornerRadius:e.width/12,border:t},exports.player={radius:25,mass:2,damping:.5,movementIncrease:2,sprintMovementIncrease:4,maxSpeed:20,sprintMaxSpeed:36,shootingStrong:100,shootingWeak:50};
},{}],"jePD":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}Object.defineProperty(exports,"__esModule",{value:!0});var a=require("./callibration"),i=function(){function t(){e(this,t)}return n(t,null,[{key:"createCanvas",value:function(){this._element=document.createElement("canvas"),this._element.width=a.canvas.size.width,this._element.height=a.canvas.size.height,this._ctx=this.element.getContext("2d"),document.body.appendChild(this.element)}},{key:"clearCanvas",value:function(){this.ctx.clearRect(0,0,a.canvas.size.width,a.canvas.size.height)}},{key:"startDraw",value:function(){this.ctx.beginPath()}},{key:"stopDraw",value:function(){this.ctx.closePath()}},{key:"element",get:function(){return this._element}},{key:"ctx",get:function(){return this._ctx}}]),t}();exports.Canvas=i;
},{"./callibration":"Gf3d"}],"bj28":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}var r;Object.defineProperty(exports,"__esModule",{value:!0}),function(e){e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.W=87]="W",e[e.S=83]="S",e[e.A=65]="A",e[e.D=68]="D",e[e.X=88]="X",e[e.Shift=16]="Shift",e[e.C=67]="C"}(r=exports.Keys||(exports.Keys={}));var i=function(){function n(){e(this,n)}return t(n,null,[{key:"bindEvents",value:function(){var e=this;document.addEventListener("keydown",function(n){e.pressed[n.which]=!0}),document.addEventListener("keyup",function(n){e.pressed[n.which]=!1})}},{key:"reactOnKeys",value:function(){var e=this;this.handlers.forEach(function(n){n.action(e.pressed[n.key])})}},{key:"add",value:function(e,n){var t=this;this.handlers.push({key:e,action:n});var r=this.handlers.length-1;return function(){t.handlers.splice(r,1)}}}]),n}();exports.KeysHandler=i,i.pressed={},i.handlers=[];
},{}],"KxjO":[function(require,module,exports) {
"use strict";function t(t,e){return{x:e.x-t.x,y:e.y-t.y}}function e(e,r){return o(t(e,r))}function r(e,r){var o=t(e.start,e.end),n=t(e.start,r),x=(o.x*n.x+o.y*n.y)/(Math.pow(o.x,2)+Math.pow(o.y,2)),a={x:0,y:0};return x<=0?(a.x=e.start.x,a.y=e.start.y):x>=1?(a.x=e.end.x,a.y=e.end.y):(a.x=e.start.x+x*o.x,a.y=e.start.y+x*o.y),Math.sqrt(Math.pow(r.x-a.x,2)+Math.pow(r.y-a.y,2))}function o(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}function n(e,r){return x(t(e,r))}function x(t){var e=o(t);return{x:t.x/e,y:t.y/e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getVector=t,exports.getDistance=e,exports.getDistanceToSegment=r,exports.calculateVectorLength=o,exports.getNormalizedVector=n,exports.normalizeVector=x;
},{}],"nnrS":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var s=0;s<e.length;s++){var a=e[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function s(t,s,a){return s&&e(t.prototype,s),a&&e(t,a),t}Object.defineProperty(exports,"__esModule",{value:!0});var a=require("./canvas"),i=require("./callibration"),n=function(){function e(){t(this,e)}return s(e,null,[{key:"setBounduary",value:function(t){this.offset=t}},{key:"updatePos",value:function(t){var e={x:t.x-i.canvas.size.width/2,y:t.y-i.canvas.size.height/2};e.x<this.offset.left&&(e.x=this.offset.left),e.x>this.offset.right-i.canvas.size.width&&(e.x=this.offset.right-i.canvas.size.width),e.y<this.offset.top&&(e.y=this.offset.top),e.y>this.offset.bottom-i.canvas.size.height&&(e.y=this.offset.bottom-i.canvas.size.height),this.pos=e}},{key:"translateStart",value:function(){this.pos&&(a.Canvas.ctx.save(),a.Canvas.ctx.translate(-this.pos.x,-this.pos.y))}},{key:"translateEnd",value:function(){this.pos&&a.Canvas.ctx.restore()}}]),e}();exports.Camera=n;
},{"./canvas":"jePD","./callibration":"Gf3d"}],"jTAD":[function(require,module,exports) {
"use strict";function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function t(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}Object.defineProperty(exports,"__esModule",{value:!0});var o,s=require("./../utils/vector"),i=require("./canvas"),r=require("./camera");!function(e){e[e.Left=1]="Left",e[e.Middle=2]="Middle",e[e.Right=3]="Right"}(o=exports.MouseClicks||(exports.MouseClicks={}));var c=function(){function n(){e(this,n)}return t(n,null,[{key:"bindEvents",value:function(){var e=this;document.addEventListener("mousedown",function(n){e.pressed[n.which]=!0}),document.addEventListener("mouseup",function(n){e.pressed[n.which]=!1}),document.addEventListener("contextmenu",function(e){e.preventDefault()}),document.addEventListener("click",function(n){e.clickHandlers.forEach(function(e){n.which===e.click&&e.action()})}),document.addEventListener("mousemove",function(n){e.browserMousePos={x:n.x,y:n.y},e.updateMousePos()})}},{key:"updateMousePos",value:function(){var e=i.Canvas.element.getBoundingClientRect(),n=e.left+i.Canvas.element.clientLeft,t=e.top+i.Canvas.element.clientTop,o={x:this.browserMousePos.x-n+r.Camera.pos.x,y:this.browserMousePos.y-t+r.Camera.pos.y};this.mousePos=o}},{key:"reactOnClicks",value:function(){var e=this;this.mousedownHandlers.forEach(function(n){e.pressed[n.click]&&n.action()})}},{key:"add",value:function(e,n){var t=this;if(arguments.length>2&&void 0!==arguments[2]&&arguments[2]){this.mousedownHandlers.push({click:e,action:n});var o=this.clickHandlers.length-1;return function(){t.clickHandlers.splice(o,1)}}this.clickHandlers.push({click:e,action:n});var s=this.clickHandlers.length-1;return function(){t.clickHandlers.splice(s,1)}}},{key:"getMousePos",value:function(e){return e?{x:this.mousePos.x-e.x,y:this.mousePos.y-e.y}:this.mousePos}},{key:"getVectorToCursor",value:function(e){var n=this.getMousePos(e);return s.getNormalizedVector({x:0,y:0},n)}}]),n}();exports.MouseHandler=c,c.browserMousePos={x:0,y:0},c.mousePos={x:0,y:0},c.pressed={},c.mousedownHandlers=[],c.clickHandlers=[];
},{"./../utils/vector":"KxjO","./canvas":"jePD","./camera":"nnrS"}],"RVGt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=1;exports.PLAYER=Math.pow(2,t++),exports.BALL=Math.pow(2,t++),exports.GOAL=Math.pow(2,t++),exports.MAP=Math.pow(2,t++),exports.MAP_BORDER=Math.pow(2,t++),exports.GOAL_POST=Math.pow(2,t++);
},{}],"Z2vY":[function(require,module,exports) {
"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(exports,"__esModule",{value:!0});var a=i(require("p2")),s=require("./canvas"),o=require("./keysHandler"),r=require("./collision"),l=require("./../utils/vector"),d=require("./camera"),y=require("./callibration"),h=function(){function t(n,i){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e(this,t),this.main=s;var o={mass:y.player.mass,position:n,velocity:[0,0]};this.body=new a.Body(o),this.shape=new a.Circle({radius:y.player.radius,collisionGroup:r.PLAYER,collisionMask:r.PLAYER|r.MAP_BORDER|r.BALL|r.GOAL_POST}),this.shape.material=i,this.body.addShape(this.shape),this.body.damping=y.player.damping,this.main&&(this.sprintHandler(),this.addMovementHandlers())}return n(t,[{key:"addMovementHandlers",value:function(){var e=this;o.KeysHandler.add(o.Keys.Up,function(t){t&&e.movementKeysHandler(o.Keys.Up)}),o.KeysHandler.add(o.Keys.Down,function(t){t&&e.movementKeysHandler(o.Keys.Down)}),o.KeysHandler.add(o.Keys.Left,function(t){t&&e.movementKeysHandler(o.Keys.Left)}),o.KeysHandler.add(o.Keys.Right,function(t){t&&e.movementKeysHandler(o.Keys.Right)}),o.KeysHandler.add(o.Keys.Shift,function(t){e.sprintHandler(t)}),o.KeysHandler.add(o.Keys.X,function(t){e.shootingStrongHandler(t)}),o.KeysHandler.add(o.Keys.C,function(t){e.shootingWeakHandler(t)})}},{key:"shootingStrongHandler",value:function(e){this.shootingStrong=e}},{key:"shootingWeakHandler",value:function(e){this.shootingWeak=e}},{key:"sprintHandler",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(this.movementIncrease=y.player.sprintMaxSpeed,this.maxSpeed=y.player.sprintMaxSpeed):(this.movementIncrease=y.player.movementIncrease,this.maxSpeed=y.player.maxSpeed)}},{key:"movementKeysHandler",value:function(e){e==o.Keys.Up&&(this.body.velocity[1]-=this.movementIncrease),e==o.Keys.Down&&(this.body.velocity[1]+=this.movementIncrease),e==o.Keys.Left&&(this.body.velocity[0]-=this.movementIncrease),e==o.Keys.Right&&(this.body.velocity[0]+=this.movementIncrease);var t={x:this.body.velocity[0],y:this.body.velocity[1]};if(l.calculateVectorLength(t)>this.maxSpeed){var n=l.normalizeVector(t);this.body.velocity[0]=n.x*this.maxSpeed,this.body.velocity[1]=n.y*this.maxSpeed}}},{key:"logic",value:function(){this.main&&(this.body.velocity[0]||this.body.velocity[1])&&d.Camera.updatePos({x:this.body.position[0],y:this.body.position[1]})}},{key:"render",value:function(){s.Canvas.startDraw(),s.Canvas.ctx.arc(this.body.position[0],this.body.position[1],this.shape.radius,0,2*Math.PI,!0),s.Canvas.ctx.fillStyle=this.color,s.Canvas.ctx.fill(),s.Canvas.ctx.strokeStyle=this.shootingStrong||this.shootingWeak?"white":"black",s.Canvas.ctx.lineWidth=3,s.Canvas.ctx.stroke(),s.Canvas.stopDraw()}}]),t}();exports.Player=h;
},{"p2":"ZMtE","./canvas":"jePD","./keysHandler":"bj28","./collision":"RVGt","./../utils/vector":"KxjO","./camera":"nnrS","./callibration":"Gf3d"}],"zi76":[function(require,module,exports) {
"use strict";function t(t,e){return{left:t.x,right:t.x+e.width,top:t.y,bottom:t.y+e.height,midVert:t.y+e.height/2,midHori:t.x+e.width/2,width:e.width,height:e.height}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getOffset=t;
},{}],"O3bx":[function(require,module,exports) {
"use strict";function e(e,t,r,o){for(var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,n=Math.PI/2/e,i=[],u=1;u<=e-1;u++)i.push([o*Math.cos(t+n*u*s)+r.x,o*Math.sin(t+n*u*s)+r.y]);return i}Object.defineProperty(exports,"__esModule",{value:!0}),exports.getCornerPoints=e;
},{}],"PoLr":[function(require,module,exports) {
"use strict";function t(t){return e(t)||r(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function r(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function e(t){if(Array.isArray(t)){for(var o=0,r=new Array(t.length);o<t.length;o++)r[o]=t[o];return r}}function i(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function a(t,o){for(var r=0;r<o.length;r++){var e=o[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function n(t,o,r){return o&&a(t.prototype,o),r&&a(t,r),t}var s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(o[r]=t[r]);return o.default=t,o};Object.defineProperty(exports,"__esModule",{value:!0});var p=s(require("p2")),h=require("./../utils/offset"),m=require("./../utils/vertices"),c=require("./canvas"),l=require("./collision"),u=require("./callibration"),d=function(){function o(t){i(this,o),this.pos={x:u.canvas.size.width/2-u.map.size.width/2,y:u.canvas.size.height/2-u.map.size.height/2},this.outerPos={x:this.pos.x-u.map.border,y:this.pos.y-u.map.border},this.topBody=new p.Body({mass:0,position:[this.pos.x,this.pos.y]}),this.topBody.fromPolygon(this.getTopShapePoints()),this.topBody.shapes.forEach(function(o){o.material=t,o.collisionGroup=l.MAP,o.collisionMask=l.BALL}),this.botBody=new p.Body({mass:0,position:[this.pos.x,this.pos.y]}),this.botBody.fromPolygon(this.getBottomShapePoints()),this.botBody.shapes.forEach(function(o){o.material=t,o.collisionGroup=l.MAP,o.collisionMask=l.BALL}),this.borderBody=new p.Body({mass:0,position:[this.pos.x,this.pos.y]}),this.borderBody.fromPolygon(this.getBorderShapePoints()),this.borderBody.shapes.forEach(function(o){o.material=t,o.collisionGroup=l.MAP_BORDER,o.collisionMask=l.PLAYER})}return n(o,[{key:"getTopShapePoints",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},r=h.getOffset(o,u.map.size);return[[r.left,r.midVert-u.goal.size.height/2],[r.left,r.top+u.map.cornerRadius]].concat(t(m.getCornerPoints(u.map.cornerPointsAmount,Math.PI,{x:r.left+u.map.cornerRadius,y:r.top+u.map.cornerRadius},u.map.cornerRadius)),[[r.left+u.map.cornerRadius,r.top],[r.right-u.map.cornerRadius,r.top]],t(m.getCornerPoints(u.map.cornerPointsAmount,Math.PI+Math.PI/2,{x:r.right-u.map.cornerRadius,y:r.top+u.map.cornerRadius},u.map.cornerRadius)),[[r.right,r.top+u.map.cornerRadius],[r.right,r.midVert-u.goal.size.height/2],[r.right+10,r.midVert-u.goal.size.height/2],[r.right+10,r.top-10],[r.left-10,r.top-10],[r.left-10,r.midVert-u.goal.size.height/2]])}},{key:"getBottomShapePoints",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},r=h.getOffset(o,u.map.size);return[[r.right,r.midVert+u.goal.size.height/2],[r.right,r.bottom-u.map.cornerRadius]].concat(t(m.getCornerPoints(u.map.cornerPointsAmount,0,{x:r.right-u.map.cornerRadius,y:r.bottom-u.map.cornerRadius},u.map.cornerRadius)),[[r.right-u.map.cornerRadius,r.bottom],[r.left+u.map.cornerRadius,r.bottom]],t(m.getCornerPoints(u.map.cornerPointsAmount,Math.PI/2,{x:r.left+u.map.cornerRadius,y:r.bottom-u.map.cornerRadius},u.map.cornerRadius)),[[r.left,r.bottom-u.map.cornerRadius],[r.left,r.midVert+u.goal.size.height/2],[r.left-10,r.midVert+u.goal.size.height/2],[r.left-10,r.bottom+10],[r.right+10,r.bottom+10],[r.right+10,r.midVert+u.goal.size.height/2]])}},{key:"getBorderShapePoints",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},o=h.getOffset(t,u.map.size);return[[o.left-u.map.border-10,o.top-u.map.border],[o.right+u.map.border,o.top-u.map.border],[o.right+u.map.border,o.bottom+u.map.border],[o.left-u.map.border,o.bottom+u.map.border],[o.left-u.map.border,o.top-u.map.border+1],[o.left-u.map.border-10,o.top-u.map.border+1],[o.left-u.map.border-10,o.bottom+u.map.border+10],[o.right+u.map.border+10,o.bottom+u.map.border+10],[o.right+u.map.border+10,o.top-u.map.border-10],[o.left-u.map.border-10,o.top-u.map.border-10]]}},{key:"logic",value:function(){}},{key:"render",value:function(){c.Canvas.startDraw();var t=this.getTopShapePoints(this.pos);c.Canvas.ctx.moveTo(t[0][0],t[0][1]),t.filter(function(o,r){return r<t.length-4}).forEach(function(t){c.Canvas.ctx.lineTo(t[0],t[1])}),c.Canvas.ctx.lineWidth=3,c.Canvas.ctx.strokeStyle="white",c.Canvas.ctx.stroke(),c.Canvas.stopDraw(),c.Canvas.startDraw();var o=this.getBottomShapePoints(this.pos);c.Canvas.ctx.moveTo(o[0][0],o[0][1]),o.filter(function(t,r){return r<o.length-4}).forEach(function(t){c.Canvas.ctx.lineTo(t[0],t[1])}),c.Canvas.ctx.lineWidth=3,c.Canvas.ctx.strokeStyle="white",c.Canvas.ctx.stroke(),c.Canvas.stopDraw()}}]),o}();exports.Map=d;
},{"p2":"ZMtE","./../utils/offset":"zi76","./../utils/vertices":"O3bx","./canvas":"jePD","./collision":"RVGt","./callibration":"Gf3d"}],"gq3r":[function(require,module,exports) {
"use strict";function a(a,e){if(!(a instanceof e))throw new TypeError("Cannot call a class as a function")}function e(a,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(a,i.key,i)}}function t(a,t,i){return t&&e(a.prototype,t),i&&e(a,i),a}var i=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var e={};if(null!=a)for(var t in a)Object.hasOwnProperty.call(a,t)&&(e[t]=a[t]);return e.default=a,e};Object.defineProperty(exports,"__esModule",{value:!0});var n=i(require("p2")),r=require("./canvas"),s=require("./collision"),o=require("./callibration"),l=function(){function e(t,i){a(this,e),this.body=new n.Body({mass:o.ball.mass,position:t}),this.shape=new n.Circle({radius:o.ball.radius,collisionGroup:s.BALL,collisionMask:s.MAP|s.GOAL|s.PLAYER|s.GOAL_POST}),this.shape.material=i,this.body.addShape(this.shape),this.body.damping=o.ball.damping}return t(e,[{key:"logic",value:function(){}},{key:"render",value:function(){r.Canvas.startDraw(),r.Canvas.ctx.arc(this.body.position[0],this.body.position[1],this.shape.radius,0,2*Math.PI,!0),r.Canvas.ctx.fillStyle="#FAFAFA",r.Canvas.ctx.fill(),r.Canvas.ctx.strokeStyle="black",r.Canvas.ctx.lineWidth=3,r.Canvas.ctx.stroke(),r.Canvas.stopDraw()}}]),e}();exports.Ball=l;
},{"p2":"ZMtE","./canvas":"jePD","./collision":"RVGt","./callibration":"Gf3d"}],"lVUQ":[function(require,module,exports) {
"use strict";function t(t){return i(t)||a(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function i(t){if(Array.isArray(t)){for(var o=0,a=new Array(t.length);o<t.length;o++)a[o]=t[o];return a}}function s(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function r(t,o){for(var a=0;a<o.length;a++){var i=o[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,o,a){return o&&r(t.prototype,o),a&&r(t,a),t}var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var a in t)Object.hasOwnProperty.call(t,a)&&(o[a]=t[a]);return o.default=t,o};Object.defineProperty(exports,"__esModule",{value:!0});var l=n(require("p2")),c=require("../utils/vertices"),h=require("../utils/offset"),p=require("./canvas"),u=require("./collision"),f=require("./callibration"),d=function(){function o(t,a){s(this,o),this.pos={x:t.x,y:t.y},this.borderBody=new l.Body({position:[this.pos.x,this.pos.y],mass:0}),this.borderBody.fromPolygon(this.getPoints()),this.borderBody.shapes.forEach(function(t){t.collisionGroup=u.GOAL,t.collisionMask=u.BALL,t.material=a}),this.postBody=new l.Body({position:[this.pos.x,this.pos.y],mass:0}),this.topPostShape=new l.Circle({radius:f.goal.postRadius,collisionGroup:u.GOAL_POST,collisionMask:u.PLAYER|u.BALL}),this.topPostShape.material=a,this.postBody.addShape(this.topPostShape,[0,0]),this.bottomPostShape=new l.Circle({radius:f.goal.postRadius,collisionGroup:u.GOAL_POST,collisionMask:u.PLAYER|u.BALL}),this.bottomPostShape.material=a,this.postBody.addShape(this.bottomPostShape,[0,f.goal.size.height])}return e(o,[{key:"getPoints",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},a=h.getOffset(o,f.goal.size);return[[a.left,a.bottom],[a.right-f.goal.cornerRadius,a.bottom]].concat(t(c.getCornerPoints(f.goal.cornerPointsAmount,Math.PI/2,{x:a.right-f.goal.cornerRadius,y:a.bottom-f.goal.cornerRadius},f.goal.cornerRadius,-1)),[[a.right,a.bottom-f.goal.cornerRadius],[a.right,a.top+f.goal.cornerRadius]],t(c.getCornerPoints(f.goal.cornerPointsAmount,0,{x:a.right-f.goal.cornerRadius,y:a.top+f.goal.cornerRadius},f.goal.cornerRadius,-1)),[[a.right-f.goal.cornerRadius,a.top],[a.left,a.top],[a.left,a.top-10],[a.right+10,a.top-10],[a.right+10,a.bottom+10],[a.left,a.bottom+10]])}},{key:"logic",value:function(){}},{key:"render",value:function(){p.Canvas.startDraw();var t=this.getPoints(this.pos);p.Canvas.ctx.moveTo(t[0][0],t[0][1]),t.filter(function(o,a){return a<t.length-4}).forEach(function(t){p.Canvas.ctx.lineTo(t[0],t[1])}),p.Canvas.ctx.lineWidth=3,p.Canvas.ctx.strokeStyle="white",p.Canvas.ctx.stroke(),p.Canvas.stopDraw(),p.Canvas.startDraw(),p.Canvas.ctx.arc(this.pos.x+this.topPostShape.position[0],this.pos.y+this.topPostShape.position[1],this.topPostShape.radius,0,2*Math.PI,!0),p.Canvas.ctx.fillStyle="#D95A62",p.Canvas.ctx.fill(),p.Canvas.ctx.lineWidth=3,p.Canvas.ctx.strokeStyle="black",p.Canvas.ctx.stroke(),p.Canvas.stopDraw(),p.Canvas.startDraw(),p.Canvas.ctx.arc(this.pos.x+this.bottomPostShape.position[0],this.pos.y+this.bottomPostShape.position[1],this.bottomPostShape.radius,0,2*Math.PI,!0),p.Canvas.ctx.fillStyle="#D95A62",p.Canvas.ctx.fill(),p.Canvas.ctx.lineWidth=3,p.Canvas.ctx.strokeStyle="black",p.Canvas.ctx.stroke(),p.Canvas.stopDraw()}}]),o}();exports.RightGoal=d;
},{"p2":"ZMtE","../utils/vertices":"O3bx","../utils/offset":"zi76","./canvas":"jePD","./collision":"RVGt","./callibration":"Gf3d"}],"vvd0":[function(require,module,exports) {
"use strict";function t(t){return s(t)||a(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function s(t){if(Array.isArray(t)){for(var o=0,a=new Array(t.length);o<t.length;o++)a[o]=t[o];return a}}function e(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}function i(t,o){for(var a=0;a<o.length;a++){var s=o[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function r(t,o,a){return o&&i(t.prototype,o),a&&i(t,a),t}var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var o={};if(null!=t)for(var a in t)Object.hasOwnProperty.call(t,a)&&(o[a]=t[a]);return o.default=t,o};Object.defineProperty(exports,"__esModule",{value:!0});var l=n(require("p2")),c=require("../utils/vertices"),h=require("../utils/offset"),p=require("./canvas"),u=require("./collision"),f=require("./callibration"),d=function(){function o(t,a){e(this,o),this.pos={x:t.x,y:t.y},this.borderBody=new l.Body({position:[this.pos.x,this.pos.y],mass:0}),this.borderBody.fromPolygon(this.getPoints()),this.borderBody.shapes.forEach(function(t){t.collisionGroup=u.GOAL,t.collisionMask=u.BALL,t.material=a}),this.postBody=new l.Body({position:[this.pos.x,this.pos.y],mass:0}),this.topPostShape=new l.Circle({radius:f.goal.postRadius,collisionGroup:u.GOAL_POST,collisionMask:u.PLAYER|u.BALL}),this.topPostShape.material=a,this.postBody.addShape(this.topPostShape,[f.goal.size.width,0]),this.bottomPostShape=new l.Circle({radius:f.goal.postRadius,collisionGroup:u.GOAL_POST,collisionMask:u.PLAYER|u.BALL}),this.bottomPostShape.material=a,this.postBody.addShape(this.bottomPostShape,[f.goal.size.width,f.goal.size.height])}return r(o,[{key:"getPoints",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0},a=h.getOffset(o,f.goal.size);return[[a.right,a.bottom],[a.left+f.goal.cornerRadius,a.bottom]].concat(t(c.getCornerPoints(f.goal.cornerPointsAmount,Math.PI/2,{x:a.left+f.goal.cornerRadius,y:a.bottom-f.goal.cornerRadius},f.goal.cornerRadius)),[[a.left,a.bottom-f.goal.cornerRadius],[a.left,a.top+f.goal.cornerRadius]],t(c.getCornerPoints(f.goal.cornerPointsAmount,Math.PI,{x:a.left+f.goal.cornerRadius,y:a.top+f.goal.cornerRadius},f.goal.cornerRadius)),[[a.left+f.goal.cornerRadius,a.top],[a.right,a.top],[a.right,a.top-10],[a.left-10,a.top-10],[a.left-10,a.bottom+10],[a.right,a.bottom+10]])}},{key:"logic",value:function(){}},{key:"render",value:function(){p.Canvas.startDraw();var t=this.getPoints(this.pos);p.Canvas.ctx.moveTo(t[0][0],t[0][1]),t.filter(function(o,a){return a<t.length-4}).forEach(function(t){p.Canvas.ctx.lineTo(t[0],t[1])}),p.Canvas.ctx.lineWidth=3,p.Canvas.ctx.strokeStyle="white",p.Canvas.ctx.stroke(),p.Canvas.stopDraw(),p.Canvas.startDraw(),p.Canvas.ctx.arc(this.pos.x+this.topPostShape.position[0],this.pos.y+this.topPostShape.position[1],this.topPostShape.radius,0,2*Math.PI,!0),p.Canvas.ctx.fillStyle="#D95A62",p.Canvas.ctx.fill(),p.Canvas.ctx.lineWidth=3,p.Canvas.ctx.strokeStyle="black",p.Canvas.ctx.stroke(),p.Canvas.stopDraw(),p.Canvas.startDraw(),p.Canvas.ctx.arc(this.pos.x+this.bottomPostShape.position[0],this.pos.y+this.bottomPostShape.position[1],this.bottomPostShape.radius,0,2*Math.PI,!0),p.Canvas.ctx.fillStyle="#D95A62",p.Canvas.ctx.fill(),p.Canvas.ctx.lineWidth=3,p.Canvas.ctx.strokeStyle="black",p.Canvas.ctx.stroke(),p.Canvas.stopDraw()}}]),o}();exports.LeftGoal=d;
},{"p2":"ZMtE","../utils/vertices":"O3bx","../utils/offset":"zi76","./canvas":"jePD","./collision":"RVGt","./callibration":"Gf3d"}],"c9RO":[function(require,module,exports) {
"use strict";function t(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function i(t,i){for(var a=0;a<i.length;a++){var e=i[a];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function a(t,a,e){return a&&i(t.prototype,a),e&&i(t,e),t}var e=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var i={};if(null!=t)for(var a in t)Object.hasOwnProperty.call(t,a)&&(i[a]=t[a]);return i.default=t,i};Object.defineProperty(exports,"__esModule",{value:!0});var s=e(require("p2")),o=require("./canvas"),l=require("./keysHandler"),r=require("./mouseHandler"),n=require("./player"),h=require("./map"),d=require("./ball"),y=require("./rightGoal"),p=require("./leftGoal"),c=require("./camera"),u=require("./callibration"),m=require("../utils/vector"),f=require("./../utils/offset"),g=function(){function i(){t(this,i),this.step={fixedTime:1/60,lastTime:0,maxSteps:10},this.mat={},this.contactMat={},this.players=[],this.teamLeft=[],this.teamRight=[],this.worldEvents=[],this.events=[],this.initHandlers(),this.initCanvas(),this.initEntities(),this.initTeams(),this.initWorld(),this.initCamera(),this.initEvents()}return a(i,[{key:"initHandlers",value:function(){l.KeysHandler.bindEvents(),r.MouseHandler.bindEvents()}},{key:"initCanvas",value:function(){o.Canvas.createCanvas()}},{key:"initEntities",value:function(){this.map=new h.Map(this.mat.map),this.leftGoal=new p.LeftGoal({x:this.map.pos.x-u.goal.size.width,y:this.map.pos.y+u.map.size.height/2-u.goal.size.height/2},this.mat.goal),this.rightGoal=new y.RightGoal({x:this.map.pos.x+u.map.size.width,y:this.map.pos.y+u.map.size.height/2-u.goal.size.height/2},this.mat.goal),this.players.push(new n.Player([0,0],this.mat.player,!0)),this.players.push(new n.Player([0,0],this.mat.player)),this.players.push(new n.Player([0,0],this.mat.player)),this.players.push(new n.Player([0,0],this.mat.player)),this.players.push(new n.Player([0,0],this.mat.player)),this.players.push(new n.Player([0,0],this.mat.player)),this.ball=new d.Ball([this.map.pos.x+u.map.size.width/2,this.map.pos.y+u.map.size.height/2],this.mat.ball)}},{key:"initTeams",value:function(){var t=this;this.teamLeft.push(this.players[0],this.players[1],this.players[2]),this.teamLeft.forEach(function(i,a){i.body.position[0]=u.map.size.width/6,i.body.position[1]=u.map.size.height/2-150*(t.teamLeft.length-1)/2+150*a,i.color="#8F1218"}),this.teamRight.push(this.players[3],this.players[4],this.players[5]),this.teamRight.forEach(function(i,a){i.body.position[0]=5*u.map.size.width/6,i.body.position[1]=u.map.size.height/2-150*(t.teamLeft.length-1)/2+150*a,i.color="#4663A0"})}},{key:"initWorld",value:function(){var t=this;this.world=new s.World({gravity:[0,0]}),this.initMaterials(),this.world.addBody(this.map.topBody),this.world.addBody(this.map.botBody),this.world.addBody(this.map.borderBody),this.world.addBody(this.leftGoal.borderBody),this.world.addBody(this.leftGoal.postBody),this.world.addBody(this.rightGoal.borderBody),this.world.addBody(this.rightGoal.postBody),this.players.forEach(function(i){t.world.addBody(i.body)}),this.world.addBody(this.ball.body)}},{key:"initMaterials",value:function(){this.mat.map=new s.Material,this.mat.player=new s.Material,this.mat.ball=new s.Material,this.mat.goal=new s.Material,this.contactMat.mapPlayer=new s.ContactMaterial(this.mat.map,this.mat.player,{friction:1}),this.contactMat.mapBall=new s.ContactMaterial(this.mat.map,this.mat.ball,{friction:0,restitution:.3}),this.contactMat.goalBall=new s.ContactMaterial(this.mat.goal,this.mat.ball,{friction:2}),this.contactMat.playerBall=new s.ContactMaterial(this.mat.player,this.mat.ball,{friction:1}),this.world.addContactMaterial(this.contactMat.mapBall),this.world.addContactMaterial(this.contactMat.playerBall),this.world.addContactMaterial(this.contactMat.goalBall),this.world.addContactMaterial(this.contactMat.mapPlayer)}},{key:"initCamera",value:function(){var t=this.players.find(function(t){return t.main});t&&(c.Camera.setBounduary(f.getOffset(this.map.outerPos,u.map.outerSize)),c.Camera.updatePos({x:t.body.position[0],y:t.body.position[1]}))}},{key:"initEvents",value:function(){var t=this,i=this.players.find(function(t){return t.main});i&&this.events.push(function(){if(i.shootingStrong||i.shootingWeak){var a={x:i.body.position[0],y:i.body.position[1]},e={x:t.ball.body.position[0],y:t.ball.body.position[1]},s=u.player.radius+u.ball.radius;if(m.getDistance(a,e)-s<3){var o=m.getNormalizedVector({x:i.body.position[0],y:i.body.position[1]},{x:t.ball.body.position[0],y:t.ball.body.position[1]});i.shootingStrong&&i.shootingWeak?(t.ball.body.velocity[0]+=o.x*(u.player.shootingStrong+u.player.shootingWeak)/2,t.ball.body.velocity[1]+=o.y*(u.player.shootingStrong+u.player.shootingWeak)/2):i.shootingStrong?(t.ball.body.velocity[0]+=o.x*u.player.shootingStrong,t.ball.body.velocity[1]+=o.y*u.player.shootingStrong):i.shootingWeak&&(t.ball.body.velocity[0]+=o.x*u.player.shootingWeak,t.ball.body.velocity[1]+=o.y*u.player.shootingWeak)}}})}},{key:"run",value:function(t){this.worldStep(t),this.logic(),this.handleEvents(),this.render()}},{key:"worldStep",value:function(t){var i=t-this.step.lastTime/1e3;this.world.step(this.step.fixedTime,i,this.step.maxSteps),this.step.lastTime=t}},{key:"logic",value:function(){l.KeysHandler.reactOnKeys(),r.MouseHandler.reactOnClicks(),this.map.logic(),this.leftGoal.logic(),this.rightGoal.logic(),this.players.forEach(function(t){t.logic()}),this.ball.logic()}},{key:"handleEvents",value:function(){this.worldEvents.length&&this.worldEvents.forEach(function(t){return t()}),this.worldEvents.length=0,this.events.length&&this.events.forEach(function(t){return t()})}},{key:"render",value:function(){o.Canvas.clearCanvas(),c.Camera.translateStart(),this.map.render(),this.leftGoal.render(),this.rightGoal.render(),this.players.forEach(function(t){t.render()}),this.ball.render(),c.Camera.translateEnd()}}]),i}();exports.Game=g;
},{"p2":"ZMtE","./canvas":"jePD","./keysHandler":"bj28","./mouseHandler":"jTAD","./player":"Z2vY","./map":"PoLr","./ball":"gq3r","./rightGoal":"lVUQ","./leftGoal":"vvd0","./camera":"nnrS","./callibration":"Gf3d","../utils/vector":"KxjO","./../utils/offset":"zi76"}],"EVxB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./utils/loop"),r=require("./models/game"),t=new r.Game;e.ticker(function(e){t.run(e)});
},{"./utils/loop":"Cyzn","./models/game":"c9RO"}]},{},["EVxB"], null)
//# sourceMappingURL=/app.0358f861.js.map